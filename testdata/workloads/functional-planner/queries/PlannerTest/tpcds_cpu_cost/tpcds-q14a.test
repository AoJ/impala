# TPCDS-Q14a first of two
with  cross_items as
 (select i_item_sk ss_item_sk
 from item,
 (select iss.i_brand_id brand_id
     ,iss.i_class_id class_id
     ,iss.i_category_id category_id
 from store_sales
     ,item iss
     ,date_dim d1
 where ss_item_sk = iss.i_item_sk
   and ss_sold_date_sk = d1.d_date_sk
   and d1.d_year between 1999 AND 1999 + 2
 intersect 
 select ics.i_brand_id
     ,ics.i_class_id
     ,ics.i_category_id
 from catalog_sales
     ,item ics
     ,date_dim d2
 where cs_item_sk = ics.i_item_sk
   and cs_sold_date_sk = d2.d_date_sk
   and d2.d_year between 1999 AND 1999 + 2
 intersect
 select iws.i_brand_id
     ,iws.i_class_id
     ,iws.i_category_id
 from web_sales
     ,item iws
     ,date_dim d3
 where ws_item_sk = iws.i_item_sk
   and ws_sold_date_sk = d3.d_date_sk
   and d3.d_year between 1999 AND 1999 + 2) t1
 where i_brand_id = brand_id
      and i_class_id = class_id
      and i_category_id = category_id
),
 avg_sales as
 (select avg(quantity*list_price) average_sales
  from (select ss_quantity quantity
             ,ss_list_price list_price
       from store_sales
           ,date_dim
       where ss_sold_date_sk = d_date_sk
         and d_year between 1999 and 1999 + 2
       union all 
       select cs_quantity quantity 
             ,cs_list_price list_price
       from catalog_sales
           ,date_dim
       where cs_sold_date_sk = d_date_sk
         and d_year between 1999 and 1999 + 2 
       union all
       select ws_quantity quantity
             ,ws_list_price list_price
       from web_sales
           ,date_dim
       where ws_sold_date_sk = d_date_sk
         and d_year between 1999 and 1999 + 2) x)
 select channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)
 from(
       select 'store' channel, i_brand_id,i_class_id
             ,i_category_id,sum(ss_quantity*ss_list_price) sales
             , count(*) number_sales
       from store_sales
           ,item
           ,date_dim
       where ss_item_sk in (select ss_item_sk from cross_items)
         and ss_item_sk = i_item_sk
         and ss_sold_date_sk = d_date_sk
         and d_year = 1999+2 
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)
       union all
       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales
       from catalog_sales
           ,item
           ,date_dim
       where cs_item_sk in (select ss_item_sk from cross_items)
         and cs_item_sk = i_item_sk
         and cs_sold_date_sk = d_date_sk
         and d_year = 1999+2 
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)
       union all
       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales
       from web_sales
           ,item
           ,date_dim
       where ws_item_sk in (select ss_item_sk from cross_items)
         and ws_item_sk = i_item_sk
         and ws_sold_date_sk = d_date_sk
         and d_year = 1999+2
         and d_moy = 11
       group by i_brand_id,i_class_id,i_category_id
       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)
 ) y
 group by rollup (channel, i_brand_id,i_class_id,i_category_id)
 order by channel,i_brand_id,i_class_id,i_category_id
LIMIT 100
---- PLAN
Max Per-Host Resource Reservation: Memory=113.19MB Threads=1
Per-Host Resource Estimates: Memory=383MB
F00:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=382.82MB mem-reservation=113.19MB thread-reservation=1 runtime-filters-memory=10.00MB
|  max-parallelism=1 segment-costs=[105908098, 99046962, 95077678, 2485152, 7101129, 314951690, 105908098, 99046962, 95077678, 2485152, 6415283, 314951690, 105908098, 99046962, 95077678, 2485152, 6074990, 314951690, 13268400, 2267013, 400, 600]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
129:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=400
|  in pipelines: 129(GETNEXT), 128(OPEN)
|
128:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=34.00MB mem-reservation=34.00MB spill-buffer=2.00MB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=323.86K cost=2267013
|  in pipelines: 128(GETNEXT), 127(OPEN)
|
127:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=113.43MB mem-reservation=56.81MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=323.86K cost=8292750
|  in pipelines: 127(GETNEXT), 30(OPEN), 72(OPEN), 114(OPEN)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=276.43K cost=4975650
|  in pipelines: 30(GETNEXT), 72(GETNEXT), 114(GETNEXT)
|
|--126:NESTED LOOP JOIN [INNER JOIN]
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=42.60K cost=0
|  |  in pipelines: 114(GETNEXT), 125(OPEN)
|  |
|  |--125:AGGREGATE [FINALIZE]
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=5041336
|  |  |  in pipelines: 125(GETNEXT), 116(OPEN), 119(OPEN), 122(OPEN)
|  |  |
|  |  115:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=5.04M cost=30248016
|  |  |  in pipelines: 116(GETNEXT), 119(GETNEXT), 122(GETNEXT)
|  |  |
|  |  |--124:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=719.38K cost=726689
|  |  |  |  in pipelines: 122(GETNEXT), 123(OPEN)
|  |  |  |
|  |  |  |--123:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 123(GETNEXT)
|  |  |  |
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=94 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=1.44M cost=1448853
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=92 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=2.88M cost=2887709
|  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |
|  |  |--117:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  116:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=90 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 116(GETNEXT)
|  |
|  114:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=42.60K cost=212980
|  |  in pipelines: 114(GETNEXT), 85(OPEN)
|  |
|  113:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: ws_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF073[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.60K cost=60571
|  |  in pipelines: 85(GETNEXT), 112(OPEN)
|  |
|  |--112:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=8B cardinality=17.98K cost=148800
|  |  |  in pipelines: 112(GETNEXT), 94(OPEN)
|  |  |
|  |  109:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  runtime filters: RF081[min_max] <- i_brand_id, RF082[min_max] <- i_category_id, RF083[min_max] <- i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=32B cardinality=148.80K cost=500400
|  |  |  in pipelines: 94(GETNEXT), 88(OPEN)
|  |  |
|  |  |--88:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=71 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 88(GETNEXT)
|  |  |
|  |  108:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=892800
|  |  |  in pipelines: 94(GETNEXT), 107(OPEN)
|  |  |
|  |  |--107:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=2158152
|  |  |  |  in pipelines: 107(GETNEXT), 100(OPEN)
|  |  |  |
|  |  |  104:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82,83 row-size=40B cardinality=719.38K cost=726689
|  |  |  |  in pipelines: 100(GETNEXT), 102(OPEN)
|  |  |  |
|  |  |  |--102:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  103:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82 row-size=32B cardinality=719.38K cost=737384
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--101:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=82 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     runtime filters: RF101[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=81 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  106:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=892800
|  |  |  in pipelines: 94(GETNEXT), 105(OPEN)
|  |  |
|  |  |--105:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=4324644
|  |  |  |  in pipelines: 105(GETNEXT), 95(OPEN)
|  |  |  |
|  |  |  99:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78,79 row-size=40B cardinality=1.44M cost=1448853
|  |  |  |  in pipelines: 95(GETNEXT), 97(OPEN)
|  |  |  |
|  |  |  |--97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  98:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78 row-size=32B cardinality=1.44M cost=1459548
|  |  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |  |
|  |  |  |--96:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=78 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 96(GETNEXT)
|  |  |  |
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     runtime filters: RF097[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=77 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  94:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=8641212
|  |  |  in pipelines: 94(GETNEXT), 89(OPEN)
|  |  |
|  |  93:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73,74 row-size=40B cardinality=2.88M cost=2887709
|  |  |  in pipelines: 89(GETNEXT), 91(OPEN)
|  |  |
|  |  |--91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=74 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 91(GETNEXT)
|  |  |
|  |  92:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  runtime filters: RF093[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73 row-size=32B cardinality=2.88M cost=2898404
|  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |
|  |  |--90:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF081[min_max] -> iss.i_brand_id, RF082[min_max] -> iss.i_category_id, RF083[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=73 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 90(GETNEXT)
|  |  |
|  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     runtime filters: RF093[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=72 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 89(GETNEXT)
|  |
|  111:HASH JOIN [INNER JOIN]
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.60K cost=60596
|  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |
|  |--86:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=69 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 86(GETNEXT)
|  |
|  110:HASH JOIN [INNER JOIN]
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  runtime filters: RF076[bloom] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.60K cost=42704
|  |  in pipelines: 85(GETNEXT), 87(OPEN)
|  |
|  |--87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=70 row-size=12B cardinality=108 cost=196955
|  |     in pipelines: 87(GETNEXT)
|  |
|  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|     HDFS partitions=1824/1824 files=1824 size=84.20MB
|     runtime filters: RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk
|     stored statistics:
|       table: rows=719.38K size=84.20MB
|       partitions: 1824/1824 rows=719.38K
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.12K est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=68 row-size=20B cardinality=42.60K(filtered from 719.38K) cost=5450832
|     in pipelines: 85(GETNEXT)
|
|--84:NESTED LOOP JOIN [INNER JOIN]
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=85.03K cost=0
|  |  in pipelines: 72(GETNEXT), 83(OPEN)
|  |
|  |--83:AGGREGATE [FINALIZE]
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=5041336
|  |  |  in pipelines: 83(GETNEXT), 74(OPEN), 77(OPEN), 80(OPEN)
|  |  |
|  |  73:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=5.04M cost=30248016
|  |  |  in pipelines: 74(GETNEXT), 77(GETNEXT), 80(GETNEXT)
|  |  |
|  |  |--82:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=719.38K cost=726689
|  |  |  |  in pipelines: 80(GETNEXT), 81(OPEN)
|  |  |  |
|  |  |  |--81:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  |--79:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=1.44M cost=1448853
|  |  |  |  in pipelines: 77(GETNEXT), 78(OPEN)
|  |  |  |
|  |  |  |--78:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 78(GETNEXT)
|  |  |  |
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=58 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=2.88M cost=2887709
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=56 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 74(GETNEXT)
|  |
|  72:AGGREGATE [FINALIZE]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=85.03K cost=425145
|  |  in pipelines: 72(GETNEXT), 43(OPEN)
|  |
|  71:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF037[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.03K cost=103004
|  |  in pipelines: 43(GETNEXT), 70(OPEN)
|  |
|  |--70:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=148800
|  |  |  in pipelines: 70(GETNEXT), 52(OPEN)
|  |  |
|  |  67:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  runtime filters: RF045[min_max] <- i_brand_id, RF046[min_max] <- i_category_id, RF047[min_max] <- i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=32B cardinality=148.80K cost=500400
|  |  |  in pipelines: 52(GETNEXT), 46(OPEN)
|  |  |
|  |  |--46:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=37 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 46(GETNEXT)
|  |  |
|  |  66:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=892800
|  |  |  in pipelines: 52(GETNEXT), 65(OPEN)
|  |  |
|  |  |--65:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=2158152
|  |  |  |  in pipelines: 65(GETNEXT), 58(OPEN)
|  |  |  |
|  |  |  62:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48,49 row-size=40B cardinality=719.38K cost=726689
|  |  |  |  in pipelines: 58(GETNEXT), 60(OPEN)
|  |  |  |
|  |  |  |--60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  61:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48 row-size=32B cardinality=719.38K cost=737384
|  |  |  |  in pipelines: 58(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--59:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=48 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     runtime filters: RF065[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=47 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  64:HASH JOIN [LEFT SEMI JOIN]
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=892800
|  |  |  in pipelines: 52(GETNEXT), 63(OPEN)
|  |  |
|  |  |--63:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=4324644
|  |  |  |  in pipelines: 63(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44,45 row-size=40B cardinality=1.44M cost=1448853
|  |  |  |  in pipelines: 53(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--55:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN]
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44 row-size=32B cardinality=1.44M cost=1459548
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--54:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=44 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     runtime filters: RF061[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=43 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  52:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=8641212
|  |  |  in pipelines: 52(GETNEXT), 47(OPEN)
|  |  |
|  |  51:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39,40 row-size=40B cardinality=2.88M cost=2887709
|  |  |  in pipelines: 47(GETNEXT), 49(OPEN)
|  |  |
|  |  |--49:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 49(GETNEXT)
|  |  |
|  |  50:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  runtime filters: RF057[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39 row-size=32B cardinality=2.88M cost=2898404
|  |  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |  |
|  |  |--48:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF045[min_max] -> iss.i_brand_id, RF046[min_max] -> iss.i_category_id, RF047[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=39 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 48(GETNEXT)
|  |  |
|  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     runtime filters: RF057[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=38 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 47(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN]
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.03K cost=103029
|  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |
|  |--44:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF037[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=35 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 44(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN]
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  runtime filters: RF040[bloom] <- d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=32B cardinality=85.03K cost=85137
|  |  in pipelines: 43(GETNEXT), 45(OPEN)
|  |
|  |--45:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=12B cardinality=108 cost=196955
|  |     in pipelines: 45(GETNEXT)
|  |
|  43:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|     HDFS partitions=1831/1831 files=1831 size=151.13MB
|     runtime filters: RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=151.13MB
|       partitions: 1831/1831 rows=1.44M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=7.18K est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=34 row-size=20B cardinality=85.03K(filtered from 1.44M) cost=5451661
|     in pipelines: 43(GETNEXT)
|
42:NESTED LOOP JOIN [INNER JOIN]
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=16B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=148.80K cost=0
|  in pipelines: 30(GETNEXT), 41(OPEN)
|
|--41:AGGREGATE [FINALIZE]
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=5041336
|  |  in pipelines: 41(GETNEXT), 32(OPEN), 35(OPEN), 38(OPEN)
|  |
|  31:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=5.04M cost=30248016
|  |  in pipelines: 32(GETNEXT), 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=719.38K cost=726689
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |     stored statistics:
|  |       table: rows=719.38K size=84.20MB
|  |       partitions: 1824/1824 rows=719.38K
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=12B cardinality=719.38K cost=91208432
|  |     in pipelines: 38(GETNEXT)
|  |
|  |--37:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=1.44M cost=1448853
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |     stored statistics:
|  |       table: rows=1.44M size=151.13MB
|  |       partitions: 1831/1831 rows=1.44M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=24 row-size=12B cardinality=1.44M cost=91566896
|  |     in pipelines: 35(GETNEXT)
|  |
|  34:HASH JOIN [INNER JOIN]
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=2.88M cost=2887709
|  |  in pipelines: 32(GETNEXT), 33(OPEN)
|  |
|  |--33:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=8B cardinality=7.30K cost=196669
|  |     in pipelines: 33(GETNEXT)
|  |
|  32:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=199.36MB
|     stored statistics:
|       table: rows=2.88M size=199.36MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=22 row-size=12B cardinality=2.88M cost=91233752
|     in pipelines: 32(GETNEXT)
|
30:AGGREGATE [FINALIZE]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=148.80K cost=852755
|  in pipelines: 30(GETNEXT), 01(OPEN)
|
29:HASH JOIN [LEFT SEMI JOIN]
|  hash predicates: ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K cost=188526
|  in pipelines: 01(GETNEXT), 28(OPEN)
|
|--28:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=148800
|  |  in pipelines: 28(GETNEXT), 10(OPEN)
|  |
|  25:HASH JOIN [INNER JOIN]
|  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  runtime filters: RF006[bloom] <- i_brand_id, RF007[bloom] <- i_category_id, RF008[bloom] <- i_class_id, RF009[min_max] <- i_brand_id, RF010[min_max] <- i_category_id, RF011[min_max] <- i_class_id
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,3 row-size=32B cardinality=148.80K cost=500400
|  |  in pipelines: 10(GETNEXT), 04(OPEN)
|  |
|  |--04:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=3 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 04(GETNEXT)
|  |
|  24:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  runtime filters: RF012[bloom] <- iws.i_brand_id, RF013[bloom] <- iws.i_category_id
|  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=892800
|  |  in pipelines: 10(GETNEXT), 23(OPEN)
|  |
|  |--23:AGGREGATE [FINALIZE]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=2158152
|  |  |  in pipelines: 23(GETNEXT), 16(OPEN)
|  |  |
|  |  20:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14,15 row-size=40B cardinality=719.38K cost=726689
|  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |
|  |  |--18:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14 row-size=32B cardinality=719.38K cost=737384
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--17:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=14 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales]
|  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |     runtime filters: RF029[min_max] -> ws_item_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=84.20MB
|  |       partitions: 1824/1824 rows=719.38K
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=13 row-size=12B cardinality=719.38K cost=91208432
|  |     in pipelines: 16(GETNEXT)
|  |
|  22:HASH JOIN [LEFT SEMI JOIN]
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  mem-estimate=8.50MB mem-reservation=8.50MB spill-buffer=512.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=892800
|  |  in pipelines: 10(GETNEXT), 21(OPEN)
|  |
|  |--21:AGGREGATE [FINALIZE]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=4324644
|  |  |  in pipelines: 21(GETNEXT), 11(OPEN)
|  |  |
|  |  15:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10,11 row-size=40B cardinality=1.44M cost=1448853
|  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |
|  |  |--13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN]
|  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  runtime filters: RF025[min_max] <- ics.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10 row-size=32B cardinality=1.44M cost=1459548
|  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |
|  |  |--12:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales]
|  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |     runtime filters: RF025[min_max] -> cs_item_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=151.13MB
|  |       partitions: 1831/1831 rows=1.44M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=12B cardinality=1.44M cost=91566896
|  |     in pipelines: 11(GETNEXT)
|  |
|  10:AGGREGATE [FINALIZE]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=8641212
|  |  in pipelines: 10(GETNEXT), 05(OPEN)
|  |
|  09:HASH JOIN [INNER JOIN]
|  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5,6 row-size=40B cardinality=2.88M cost=2887709
|  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |
|  |--07:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=196669
|  |     in pipelines: 07(GETNEXT)
|  |
|  08:HASH JOIN [INNER JOIN]
|  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  runtime filters: RF021[min_max] <- iss.i_item_sk
|  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5 row-size=32B cardinality=2.88M cost=2898404
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--06:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF009[min_max] -> iss.i_brand_id, RF010[min_max] -> iss.i_category_id, RF011[min_max] -> iss.i_class_id, RF006[bloom] -> iss.i_brand_id, RF007[bloom] -> iss.i_category_id, RF008[bloom] -> iss.i_class_id, RF012[bloom] -> iss.i_brand_id, RF013[bloom] -> iss.i_category_id
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=5 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
|     HDFS partitions=1824/1824 files=1824 size=199.36MB
|     runtime filters: RF021[min_max] -> ss_item_sk
|     stored statistics:
|       table: rows=2.88M size=199.36MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=12B cardinality=2.88M cost=91233752
|     in pipelines: 05(GETNEXT)
|
27:HASH JOIN [INNER JOIN]
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  runtime filters: RF002[bloom] <- i_item_sk, RF003[min_max] <- i_item_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K cost=188551
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--02:SCAN HDFS [tpcds_partitioned_parquet_snap.item]
|     HDFS partitions=1/1 files=1 size=1.73MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=18.00K size=1.73MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=18.00K
|     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|     tuple-ids=1 row-size=20B cardinality=18.00K cost=50352
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN]
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  runtime filters: RF004[bloom] <- d_date_sk
|  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=32B cardinality=170.55K cost=170659
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=196955
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales]
   HDFS partitions=1824/1824 files=1824 size=199.36MB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk, RF002[bloom] -> ss_item_sk
   stored statistics:
     table: rows=2.88M size=199.36MB
     partitions: 1824/1824 rows=2.88M
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
   tuple-ids=0 row-size=20B cardinality=170.55K(filtered from 2.88M) cost=5453331
   in pipelines: 01(GETNEXT)
---- DISTRIBUTEDPLAN
Max Per-Host Resource Reservation: Memory=846.44MB Threads=202
Per-Host Resource Estimates: Memory=3.21GB
F81:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.03MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[606] cpu-comparison-result=255 [max(1 (self) vs 255 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
216:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  limit: 100
|  mem-estimate=32.03KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=6
|  in pipelines: 129(GETNEXT)
|
F80:PLAN FRAGMENT [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)] hosts=3 instances=6 (adjusted from 48)
Per-Instance Resources: mem-estimate=68.52MB mem-reservation=30.44MB thread-reservation=1
max-parallelism=6 segment-costs=[2025384, 2267013, 400, 6] cpu-comparison-result=255 [max(6 (self) vs 255 (sum children))]
129:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=400
|  in pipelines: 129(GETNEXT), 128(OPEN)
|
128:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=323.86K cost=2267013
|  in pipelines: 128(GETNEXT), 215(OPEN)
|
215:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=57.00MB mem-reservation=25.69MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=323.86K cost=1943154
|  in pipelines: 215(GETNEXT), 151(OPEN), 179(OPEN), 207(OPEN)
|
214:EXCHANGE [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)]
|  mem-estimate=11.52MB mem-reservation=0B thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=323.86K cost=82230
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
F79:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
Per-Instance Resources: mem-estimate=82.03MB mem-reservation=42.88MB thread-reservation=1
max-parallelism=6 segment-costs=[749813, 428467, 214644, 13268400, 82230] cpu-comparison-result=255 [max(6 (self) vs 255 (sum children))]
127:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=64.00MB mem-reservation=40.00MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=323.86K cost=8292750
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=276.43K cost=4975650
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
|--126:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=42.60K cost=0
|  |  in pipelines: 207(GETNEXT), 212(OPEN)
|  |
|  |--F90:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[3] cpu-comparison-result=33 [max(3 (self) vs 33 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  213:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=3
|  |  |  in pipelines: 212(GETNEXT)
|  |  |
|  |  F78:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=2 segment-costs=[2, 1] cpu-comparison-result=33 [max(2 (self) vs 33 (sum children))]
|  |  212:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 212(GETNEXT), 125(OPEN)
|  |  |
|  |  211:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 125(GETNEXT)
|  |  |
|  |  F77:PLAN FRAGMENT [RANDOM] hosts=3 instances=33 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=33 segment-costs=[314339768, 1] cpu-comparison-result=33 [max(33 (self) vs 12 (sum children))]
|  |  125:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=5041336
|  |  |  in pipelines: 125(GETNEXT), 116(OPEN), 119(OPEN), 122(OPEN)
|  |  |
|  |  115:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=5.04M cost=30248016
|  |  |  in pipelines: 116(GETNEXT), 119(GETNEXT), 122(GETNEXT)
|  |  |
|  |  |--124:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 122(GETNEXT), 123(OPEN)
|  |  |  |
|  |  |  |--F93:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 123(GETNEXT)
|  |  |  |  |
|  |  |  |  F76:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 123(GETNEXT)
|  |  |  |
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=94 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--F92:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=93 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |  |
|  |  |  |  F74:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=92 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |
|  |  |--F91:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  208:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=91 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  F72:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  116:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=90 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 116(GETNEXT)
|  |
|  207:AGGREGATE [FINALIZE]
|  |  output: sum:merge(ws_quantity * ws_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=42.60K cost=212980
|  |  in pipelines: 207(GETNEXT), 85(OPEN)
|  |
|  206:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=739.17KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=42.60K cost=1664
|  |  in pipelines: 85(GETNEXT)
|  |
|  F55:PLAN FRAGMENT [HASH(ws_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=11.61MB mem-reservation=2.00MB thread-reservation=1
|  max-parallelism=6 segment-costs=[299836, 1664] cpu-comparison-result=54 [max(12 (self) vs 54 (sum children))]
|  114:AGGREGATE [STREAMING]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=42.60K cost=212980
|  |  in pipelines: 85(GETNEXT)
|  |
|  113:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=36
|  |  hash predicates: ws_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.60K cost=42596
|  |  in pipelines: 85(GETNEXT), 205(OPEN)
|  |
|  |--F118:PLAN FRAGMENT [HASH(ws_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=11.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[18186, 17975] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=36 plan-id=37 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF073[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=17975
|  |  |
|  |  205:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=8B cardinality=17.98K cost=17975
|  |  |  in pipelines: 205(GETNEXT), 192(OPEN)
|  |  |
|  |  204:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=118.81KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=170 row-size=8B cardinality=17.98K cost=211
|  |  |  in pipelines: 192(GETNEXT)
|  |  |
|  |  F59:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=20.76MB mem-reservation=3.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 1488000, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  112:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=8B cardinality=17.98K cost=148800
|  |  |  in pipelines: 192(GETNEXT)
|  |  |
|  |  109:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=37
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=32B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 88(OPEN)
|  |  |
|  |  |--F119:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[54422]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=37 plan-id=38 cohort-id=11
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF081[min_max] <- i_brand_id, RF082[min_max] <- i_category_id, RF083[min_max] <- i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=54000
|  |  |  |
|  |  |  203:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=20B cardinality=18.00K cost=422
|  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  88:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=71 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 88(GETNEXT)
|  |  |
|  |  108:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=38
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 201(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=38 plan-id=39 cohort-id=11
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  202:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 201(GETNEXT)
|  |  |  |
|  |  |  F67:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  201:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 201(GETNEXT), 100(OPEN)
|  |  |  |
|  |  |  200:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  F64:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=3.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[94805352, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  107:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=3.00MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=2158152
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  104:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=39
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82,83 row-size=40B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 100(GETNEXT), 102(OPEN)
|  |  |  |
|  |  |  |--F121:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=12
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  199:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=83 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |  |
|  |  |  |  F66:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  103:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=40
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82 row-size=32B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=40 plan-id=41 cohort-id=12
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  198:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=82 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=82 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     runtime filters: RF101[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=81 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  106:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=41
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 196(OPEN)
|  |  |
|  |  |--F123:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=41 plan-id=42 cohort-id=11
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  197:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 196(GETNEXT)
|  |  |  |
|  |  |  F63:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  196:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 196(GETNEXT), 95(OPEN)
|  |  |  |
|  |  |  195:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F60:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[98774636, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  105:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=4324644
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=42
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78,79 row-size=40B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 95(GETNEXT), 97(OPEN)
|  |  |  |
|  |  |  |--F124:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=42 plan-id=43 cohort-id=13
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  194:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=79 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 97(GETNEXT)
|  |  |  |  |
|  |  |  |  F62:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  98:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=43
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78 row-size=32B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |  |
|  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=43 plan-id=44 cohort-id=13
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  193:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=78 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 96(GETNEXT)
|  |  |  |  |
|  |  |  |  F61:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=78 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 96(GETNEXT)
|  |  |  |
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     runtime filters: RF097[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=77 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  192:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 89(OPEN)
|  |  |
|  |  191:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  F56:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[105635772, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  94:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=8641212
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  93:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=44
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73,74 row-size=40B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 89(GETNEXT), 91(OPEN)
|  |  |
|  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=44 plan-id=45 cohort-id=11
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  190:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=74 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 91(GETNEXT)
|  |  |  |
|  |  |  F58:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=74 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 91(GETNEXT)
|  |  |
|  |  92:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=45
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73 row-size=32B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |
|  |  |--F127:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=45 plan-id=46 cohort-id=11
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF093[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  F57:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF081[min_max] -> iss.i_brand_id, RF082[min_max] -> iss.i_category_id, RF083[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=73 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 90(GETNEXT)
|  |  |
|  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     runtime filters: RF093[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=72 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 89(GETNEXT)
|  |
|  111:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=46
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.60K cost=42596
|  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |
|  |--F128:PLAN FRAGMENT [HASH(ws_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[18422]
|  |  JOIN BUILD
|  |  |  join-table-id=46 plan-id=47 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |
|  |  188:EXCHANGE [HASH(i_item_sk)]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=69 row-size=20B cardinality=18.00K cost=422
|  |  |  in pipelines: 86(GETNEXT)
|  |  |
|  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=69 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 86(GETNEXT)
|  |
|  187:EXCHANGE [HASH(ws_item_sk)]
|  |  mem-estimate=683.71KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.60K cost=1664
|  |  in pipelines: 85(GETNEXT)
|  |
|  F52:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=128.00KB thread-reservation=1
|  max-parallelism=6 segment-costs=[5495092]
|  110:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=47
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.60K cost=42596
|  |  in pipelines: 85(GETNEXT), 87(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=3 segment-costs=[114]
|  |  JOIN BUILD
|  |  |  join-table-id=47 plan-id=48 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF076[bloom] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  186:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=70 row-size=12B cardinality=108 cost=6
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F53:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196957]
|  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=70 row-size=12B cardinality=108 cost=196955
|  |     in pipelines: 87(GETNEXT)
|  |
|  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=84.20MB
|     runtime filters: RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk
|     stored statistics:
|       table: rows=719.38K size=84.20MB
|       partitions: 1824/1824 rows=719.38K
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.12K est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=68 row-size=20B cardinality=42.60K(filtered from 719.38K) cost=5450832
|     in pipelines: 85(GETNEXT)
|
|--84:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=85.03K cost=0
|  |  in pipelines: 179(GETNEXT), 184(OPEN)
|  |
|  |--F86:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[3] cpu-comparison-result=33 [max(3 (self) vs 33 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  185:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=3
|  |  |  in pipelines: 184(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=2 segment-costs=[2, 1] cpu-comparison-result=33 [max(2 (self) vs 33 (sum children))]
|  |  184:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 184(GETNEXT), 83(OPEN)
|  |  |
|  |  183:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 83(GETNEXT)
|  |  |
|  |  F50:PLAN FRAGMENT [RANDOM] hosts=3 instances=33 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=33 segment-costs=[314339768, 1] cpu-comparison-result=33 [max(33 (self) vs 12 (sum children))]
|  |  83:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=5041336
|  |  |  in pipelines: 83(GETNEXT), 74(OPEN), 77(OPEN), 80(OPEN)
|  |  |
|  |  73:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=5.04M cost=30248016
|  |  |  in pipelines: 74(GETNEXT), 77(GETNEXT), 80(GETNEXT)
|  |  |
|  |  |--82:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 80(GETNEXT), 81(OPEN)
|  |  |  |
|  |  |  |--F89:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  182:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 81(GETNEXT)
|  |  |  |  |
|  |  |  |  F49:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  |--79:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 77(GETNEXT), 78(OPEN)
|  |  |  |
|  |  |  |--F88:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  181:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 78(GETNEXT)
|  |  |  |  |
|  |  |  |  F47:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  78:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 78(GETNEXT)
|  |  |  |
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=58 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--F87:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 75(GETNEXT)
|  |  |  |
|  |  |  F45:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=56 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 74(GETNEXT)
|  |
|  179:AGGREGATE [FINALIZE]
|  |  output: sum:merge(cs_quantity * cs_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=85.03K cost=425145
|  |  in pipelines: 179(GETNEXT), 43(OPEN)
|  |
|  178:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=1.21MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=85.03K cost=3322
|  |  in pipelines: 43(GETNEXT)
|  |
|  F26:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=26.94MB mem-reservation=2.12MB thread-reservation=1
|  max-parallelism=6 segment-costs=[6131893, 3322] cpu-comparison-result=51 [max(6 (self) vs 51 (sum children))]
|  72:AGGREGATE [STREAMING]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=85.03K cost=425145
|  |  in pipelines: 43(GETNEXT)
|  |
|  71:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  |  hash-table-id=24
|  |  hash predicates: cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.03K cost=85029
|  |  in pipelines: 43(GETNEXT), 176(OPEN)
|  |
|  |--F106:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.08MB mem-reservation=3.88MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[18608] cpu-comparison-result=43 [max(3 (self) vs 43 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=24 plan-id=25 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF037[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=17975
|  |  |
|  |  177:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=212.43KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=633
|  |  |  in pipelines: 176(GETNEXT)
|  |  |
|  |  F42:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=10.12MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[18186, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  176:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=17975
|  |  |  in pipelines: 176(GETNEXT), 163(OPEN)
|  |  |
|  |  175:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=118.81KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=211
|  |  |  in pipelines: 163(GETNEXT)
|  |  |
|  |  F32:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=20.76MB mem-reservation=3.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 1488000, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  70:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=148800
|  |  |  in pipelines: 163(GETNEXT)
|  |  |
|  |  67:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=25
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=32B cardinality=148.80K cost=446400
|  |  |  in pipelines: 163(GETNEXT), 46(OPEN)
|  |  |
|  |  |--F107:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[54422]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=08
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF045[min_max] <- i_brand_id, RF046[min_max] <- i_category_id, RF047[min_max] <- i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=54000
|  |  |  |
|  |  |  174:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=37 row-size=20B cardinality=18.00K cost=422
|  |  |  |  in pipelines: 46(GETNEXT)
|  |  |  |
|  |  |  F41:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  46:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=37 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 46(GETNEXT)
|  |  |
|  |  66:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=26
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 163(GETNEXT), 172(OPEN)
|  |  |
|  |  |--F108:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=08
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  173:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 172(GETNEXT)
|  |  |  |
|  |  |  F40:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  172:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 172(GETNEXT), 58(OPEN)
|  |  |  |
|  |  |  171:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=3.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[94805352, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=3.00MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=2158152
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  62:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48,49 row-size=40B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 58(GETNEXT), 60(OPEN)
|  |  |  |
|  |  |  |--F109:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=09
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  170:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=49 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48 row-size=32B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 58(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--F110:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=09
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  169:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=48 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=48 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     runtime filters: RF065[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=47 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  64:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=29
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 163(GETNEXT), 167(OPEN)
|  |  |
|  |  |--F111:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=29 plan-id=30 cohort-id=08
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  168:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 167(GETNEXT)
|  |  |  |
|  |  |  F36:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  167:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 167(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  166:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F33:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[98774636, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  63:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=4324644
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=30
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44,45 row-size=40B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 53(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--F112:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=30 plan-id=31 cohort-id=10
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 55(GETNEXT)
|  |  |  |  |
|  |  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=31
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44 row-size=32B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=31 plan-id=32 cohort-id=10
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  164:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=44 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=44 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     runtime filters: RF061[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=43 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  163:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 163(GETNEXT), 47(OPEN)
|  |  |
|  |  162:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  F29:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[105635772, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  52:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=8641212
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  51:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=32
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39,40 row-size=40B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 47(GETNEXT), 49(OPEN)
|  |  |
|  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=32 plan-id=33 cohort-id=08
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  161:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 49(GETNEXT)
|  |  |  |
|  |  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 49(GETNEXT)
|  |  |
|  |  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=33
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39 row-size=32B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |  |
|  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=08
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF057[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  160:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=39 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  F30:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF045[min_max] -> iss.i_brand_id, RF046[min_max] -> iss.i_category_id, RF047[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=39 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 48(GETNEXT)
|  |  |
|  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     runtime filters: RF057[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=38 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 47(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=34
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.03K cost=85029
|  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |
|  |--F116:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.24MB mem-reservation=3.88MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[19266]
|  |  JOIN BUILD
|  |  |  join-table-id=34 plan-id=35 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |
|  |  159:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=35 row-size=20B cardinality=18.00K cost=1266
|  |  |  in pipelines: 44(GETNEXT)
|  |  |
|  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  44:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF037[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=35 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 44(GETNEXT)
|  |
|  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=35
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=32B cardinality=85.03K cost=85029
|  |  in pipelines: 43(GETNEXT), 45(OPEN)
|  |
|  |--F117:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=3 segment-costs=[114]
|  |  JOIN BUILD
|  |  |  join-table-id=35 plan-id=36 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF040[bloom] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  158:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=12B cardinality=108 cost=6
|  |  |  in pipelines: 45(GETNEXT)
|  |  |
|  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196957]
|  |  45:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=12B cardinality=108 cost=196955
|  |     in pipelines: 45(GETNEXT)
|  |
|  43:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=151.13MB
|     runtime filters: RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=151.13MB
|       partitions: 1831/1831 rows=1.44M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=7.18K est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=34 row-size=20B cardinality=85.03K(filtered from 1.44M) cost=5451661
|     in pipelines: 43(GETNEXT)
|
42:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=148.80K cost=0
|  in pipelines: 151(GETNEXT), 156(OPEN)
|
|--F82:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=3 segment-costs=[3] cpu-comparison-result=33 [max(3 (self) vs 33 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  157:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=3
|  |  in pipelines: 156(GETNEXT)
|  |
|  F25:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  max-parallelism=2 segment-costs=[2, 1] cpu-comparison-result=33 [max(2 (self) vs 33 (sum children))]
|  156:AGGREGATE [FINALIZE]
|  |  output: avg:merge(quantity * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=1
|  |  in pipelines: 156(GETNEXT), 41(OPEN)
|  |
|  155:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=1
|  |  in pipelines: 41(GETNEXT)
|  |
|  F24:PLAN FRAGMENT [RANDOM] hosts=3 instances=33 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=33 segment-costs=[314339768, 1] cpu-comparison-result=33 [max(33 (self) vs 12 (sum children))]
|  41:AGGREGATE
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=5041336
|  |  in pipelines: 41(GETNEXT), 32(OPEN), 35(OPEN), 38(OPEN)
|  |
|  31:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=5.04M cost=30248016
|  |  in pipelines: 32(GETNEXT), 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=719.38K cost=719384
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--F85:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  154:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 39(GETNEXT)
|  |  |  |
|  |  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |     stored statistics:
|  |       table: rows=719.38K size=84.20MB
|  |       partitions: 1824/1824 rows=719.38K
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=12B cardinality=719.38K cost=91208432
|  |     in pipelines: 38(GETNEXT)
|  |
|  |--37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=1.44M cost=1441548
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--F84:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  153:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 36(GETNEXT)
|  |  |  |
|  |  |  F21:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |     stored statistics:
|  |       table: rows=1.44M size=151.13MB
|  |       partitions: 1831/1831 rows=1.44M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=24 row-size=12B cardinality=1.44M cost=91566896
|  |     in pipelines: 35(GETNEXT)
|  |
|  34:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=2.88M cost=2880404
|  |  in pipelines: 32(GETNEXT), 33(OPEN)
|  |
|  |--F83:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[7563]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: d_date_sk
|  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  152:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=8B cardinality=7.30K cost=258
|  |  |  in pipelines: 33(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196755]
|  |  33:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=8B cardinality=7.30K cost=196669
|  |     in pipelines: 33(GETNEXT)
|  |
|  32:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=199.36MB
|     stored statistics:
|       table: rows=2.88M size=199.36MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=22 row-size=12B cardinality=2.88M cost=91233752
|     in pipelines: 32(GETNEXT)
|
151:AGGREGATE [FINALIZE]
|  output: sum:merge(ss_quantity * ss_list_price), count:merge(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=148.80K cost=744000
|  in pipelines: 151(GETNEXT), 01(OPEN)
|
150:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  mem-estimate=1.94MB mem-reservation=0B thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=148.80K cost=5813
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
Per-Instance Resources: mem-estimate=26.94MB mem-reservation=3.00MB thread-reservation=1
max-parallelism=6 segment-costs=[6817739, 5813] cpu-comparison-result=51 [max(6 (self) vs 51 (sum children))]
30:AGGREGATE [STREAMING]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=148.80K cost=852755
|  in pipelines: 01(GETNEXT)
|
29:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K cost=170551
|  in pipelines: 01(GETNEXT), 148(OPEN)
|
|--F94:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=5.08MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=3 segment-costs=[18608] cpu-comparison-result=43 [max(3 (self) vs 43 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=17975
|  |
|  149:EXCHANGE [BROADCAST]
|  |  mem-estimate=212.43KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=633
|  |  in pipelines: 148(GETNEXT)
|  |
|  F16:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=10.12MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=6 segment-costs=[18186, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  148:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=17975
|  |  in pipelines: 148(GETNEXT), 135(OPEN)
|  |
|  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  mem-estimate=118.81KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=211
|  |  in pipelines: 135(GETNEXT)
|  |
|  F06:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=20.76MB mem-reservation=3.94MB thread-reservation=1
|  max-parallelism=6 segment-costs=[448725, 1488000, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=148800
|  |  in pipelines: 135(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,3 row-size=32B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 04(OPEN)
|  |
|  |--F95:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=5.30MB mem-reservation=4.94MB thread-reservation=1 runtime-filters-memory=3.00MB
|  |  |  max-parallelism=6 segment-costs=[54422]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  runtime filters: RF006[bloom] <- i_brand_id, RF007[bloom] <- i_category_id, RF008[bloom] <- i_class_id, RF009[min_max] <- i_brand_id, RF010[min_max] <- i_category_id, RF011[min_max] <- i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=54000
|  |  |
|  |  146:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=3 row-size=20B cardinality=18.00K cost=422
|  |  |  in pipelines: 04(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  04:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=3 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 04(GETNEXT)
|  |
|  24:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=14
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 144(OPEN)
|  |
|  |--F96:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=4.60MB mem-reservation=3.94MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  runtime filters: RF012[bloom] <- iws.i_brand_id, RF013[bloom] <- iws.i_category_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |
|  |  145:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 144(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  144:AGGREGATE [FINALIZE]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 144(GETNEXT), 16(OPEN)
|  |  |
|  |  143:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=3.12MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[94805352, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  23:AGGREGATE [STREAMING]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=3.00MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=2158152
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=15
|  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14,15 row-size=40B cardinality=719.38K cost=719384
|  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |
|  |  |--F97:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=15 plan-id=16 cohort-id=06
|  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  142:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  18:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14 row-size=32B cardinality=719.38K cost=719384
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--F98:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=06
|  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  141:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=14 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=14 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |     runtime filters: RF029[min_max] -> ws_item_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=84.20MB
|  |       partitions: 1824/1824 rows=719.38K
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=13 row-size=12B cardinality=719.38K cost=91208432
|  |     in pipelines: 16(GETNEXT)
|  |
|  22:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=17
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 139(OPEN)
|  |
|  |--F99:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |
|  |  140:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 139(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  139:AGGREGATE [FINALIZE]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 139(GETNEXT), 11(OPEN)
|  |  |
|  |  138:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[98774636, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=4324644
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  15:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10,11 row-size=40B cardinality=1.44M cost=1441548
|  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |
|  |  |--F100:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=07
|  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  137:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10 row-size=32B cardinality=1.44M cost=1441548
|  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |
|  |  |--F101:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=07
|  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  runtime filters: RF025[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  136:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |     runtime filters: RF025[min_max] -> cs_item_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=151.13MB
|  |       partitions: 1831/1831 rows=1.44M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=12B cardinality=1.44M cost=91566896
|  |     in pipelines: 11(GETNEXT)
|  |
|  135:AGGREGATE [FINALIZE]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 05(OPEN)
|  |
|  134:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=2325
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  max-parallelism=12 segment-costs=[105635772, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  10:AGGREGATE [STREAMING]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=8641212
|  |  in pipelines: 05(GETNEXT)
|  |
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=20
|  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5,6 row-size=40B cardinality=2.88M cost=2880404
|  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |
|  |--F102:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[7563]
|  |  JOIN BUILD
|  |  |  join-table-id=20 plan-id=21 cohort-id=05
|  |  |  build expressions: d1.d_date_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  133:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=8B cardinality=7.30K cost=258
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196755]
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=196669
|  |     in pipelines: 07(GETNEXT)
|  |
|  08:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=21
|  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5 row-size=32B cardinality=2.88M cost=2880404
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--F103:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[19266]
|  |  JOIN BUILD
|  |  |  join-table-id=21 plan-id=22 cohort-id=05
|  |  |  build expressions: iss.i_item_sk
|  |  |  runtime filters: RF021[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |
|  |  132:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=5 row-size=20B cardinality=18.00K cost=1266
|  |  |  in pipelines: 06(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Shared Resources: mem-estimate=5.00MB mem-reservation=5.00MB thread-reservation=0 runtime-filters-memory=5.00MB
|  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  06:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF009[min_max] -> iss.i_brand_id, RF010[min_max] -> iss.i_category_id, RF011[min_max] -> iss.i_class_id, RF006[bloom] -> iss.i_brand_id, RF007[bloom] -> iss.i_category_id, RF008[bloom] -> iss.i_class_id, RF012[bloom] -> iss.i_brand_id, RF013[bloom] -> iss.i_category_id
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=5 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=199.36MB
|     runtime filters: RF021[min_max] -> ss_item_sk
|     stored statistics:
|       table: rows=2.88M size=199.36MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=12B cardinality=2.88M cost=91233752
|     in pipelines: 05(GETNEXT)
|
27:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=22
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K cost=170551
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--F104:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=5.24MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=3 segment-costs=[19266]
|  JOIN BUILD
|  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  build expressions: i_item_sk
|  |  runtime filters: RF002[bloom] <- i_item_sk, RF003[min_max] <- i_item_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |
|  131:EXCHANGE [BROADCAST]
|  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=20B cardinality=18.00K cost=1266
|  |  in pipelines: 02(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[50774]
|  02:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.73MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=18.00K size=1.73MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=18.00K
|     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|     tuple-ids=1 row-size=20B cardinality=18.00K cost=50352
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=23
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=32B cardinality=170.55K cost=170551
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--F105:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=3 segment-costs=[114]
|  JOIN BUILD
|  |  join-table-id=23 plan-id=24 cohort-id=01
|  |  build expressions: d_date_sk
|  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  130:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=6
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[196957]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=196955
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=199.36MB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk, RF002[bloom] -> ss_item_sk
   stored statistics:
     table: rows=2.88M size=199.36MB
     partitions: 1824/1824 rows=2.88M
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
   tuple-ids=0 row-size=20B cardinality=170.55K(filtered from 2.88M) cost=5453331
   in pipelines: 01(GETNEXT)
---- PARALLELPLANS
Max Per-Host Resource Reservation: Memory=846.44MB Threads=204
Per-Host Resource Estimates: Memory=3.21GB
F82:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=4.03MB mem-reservation=4.00MB thread-reservation=1
|  max-parallelism=1 segment-costs=[606] cpu-comparison-result=258 [max(1 (self) vs 258 (sum children))]
PLAN-ROOT SINK
|  output exprs: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END, aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(sales) WHEN 105 THEN sum(sales) WHEN 106 THEN sum(sales) WHEN 107 THEN sum(sales) WHEN 108 THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (104, 105, 106, 107, 108), CASE valid_tid(104,105,106,107,108) WHEN 104 THEN sum(number_sales) WHEN 105 THEN sum(number_sales) WHEN 106 THEN sum(number_sales) WHEN 107 THEN sum(number_sales) WHEN 108 THEN sum(number_sales) END)
|  mem-estimate=4.00MB mem-reservation=4.00MB spill-buffer=2.00MB thread-reservation=0 cost=600
|
216:MERGING-EXCHANGE [UNPARTITIONED]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  limit: 100
|  mem-estimate=32.03KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=6
|  in pipelines: 129(GETNEXT)
|
F81:PLAN FRAGMENT [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)] hosts=3 instances=6 (adjusted from 48)
Per-Instance Resources: mem-estimate=68.52MB mem-reservation=30.44MB thread-reservation=1
max-parallelism=6 segment-costs=[2025384, 2267013, 400, 6] cpu-comparison-result=258 [max(6 (self) vs 258 (sum children))]
129:TOP-N [LIMIT=100]
|  order by: CASE valid_tid(104,105,106,107,108) WHEN 104 THEN channel WHEN 105 THEN channel WHEN 106 THEN channel WHEN 107 THEN channel WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_brand_id WHEN 105 THEN i_brand_id WHEN 106 THEN i_brand_id WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_class_id WHEN 105 THEN i_class_id WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC, CASE valid_tid(104,105,106,107,108) WHEN 104 THEN i_category_id WHEN 105 THEN NULL WHEN 106 THEN NULL WHEN 107 THEN NULL WHEN 108 THEN NULL END ASC
|  mem-estimate=4.69KB mem-reservation=0B thread-reservation=0
|  tuple-ids=110 row-size=48B cardinality=100 cost=400
|  in pipelines: 129(GETNEXT), 128(OPEN)
|
128:AGGREGATE [FINALIZE]
|  output: aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(sales) WHEN CAST(105 AS INT) THEN sum(sales) WHEN CAST(106 AS INT) THEN sum(sales) WHEN CAST(107 AS INT) THEN sum(sales) WHEN CAST(108 AS INT) THEN sum(sales) END), aggif(valid_tid(104,105,106,107,108) IN (CAST(104 AS INT), CAST(105 AS INT), CAST(106 AS INT), CAST(107 AS INT), CAST(108 AS INT)), CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN sum(number_sales) WHEN CAST(105 AS INT) THEN sum(number_sales) WHEN CAST(106 AS INT) THEN sum(number_sales) WHEN CAST(107 AS INT) THEN sum(number_sales) WHEN CAST(108 AS INT) THEN sum(number_sales) END)
|  group by: CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN channel WHEN CAST(105 AS INT) THEN channel WHEN CAST(106 AS INT) THEN channel WHEN CAST(107 AS INT) THEN channel WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_brand_id WHEN CAST(105 AS INT) THEN i_brand_id WHEN CAST(106 AS INT) THEN i_brand_id WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_class_id WHEN CAST(105 AS INT) THEN i_class_id WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN i_category_id WHEN CAST(105 AS INT) THEN NULL WHEN CAST(106 AS INT) THEN NULL WHEN CAST(107 AS INT) THEN NULL WHEN CAST(108 AS INT) THEN NULL END, CASE valid_tid(104,105,106,107,108) WHEN CAST(104 AS INT) THEN CAST(104 AS INT) WHEN CAST(105 AS INT) THEN CAST(105 AS INT) WHEN CAST(106 AS INT) THEN CAST(106 AS INT) WHEN CAST(107 AS INT) THEN CAST(107 AS INT) WHEN CAST(108 AS INT) THEN CAST(108 AS INT) END
|  mem-estimate=10.00MB mem-reservation=4.75MB spill-buffer=256.00KB thread-reservation=0
|  tuple-ids=109 row-size=52B cardinality=323.86K cost=2267013
|  in pipelines: 128(GETNEXT), 215(OPEN)
|
215:AGGREGATE [FINALIZE]
|  Class 0
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum:merge(sales), sum:merge(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=57.00MB mem-reservation=25.69MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=323.86K cost=1943154
|  in pipelines: 215(GETNEXT), 151(OPEN), 179(OPEN), 207(OPEN)
|
214:EXCHANGE [HASH(CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(channel) WHEN 105 THEN murmur_hash(channel) WHEN 106 THEN murmur_hash(channel) WHEN 107 THEN murmur_hash(channel) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_brand_id) WHEN 105 THEN murmur_hash(i_brand_id) WHEN 106 THEN murmur_hash(i_brand_id) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_class_id) WHEN 105 THEN murmur_hash(i_class_id) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END,CASE valid_tid(104,105,106,107,108) WHEN 104 THEN murmur_hash(i_category_id) WHEN 105 THEN murmur_hash(NULL) WHEN 106 THEN murmur_hash(NULL) WHEN 107 THEN murmur_hash(NULL) WHEN 108 THEN murmur_hash(NULL) END)]
|  mem-estimate=11.52MB mem-reservation=0B thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=323.86K cost=82230
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
F80:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
Per-Instance Resources: mem-estimate=82.03MB mem-reservation=42.88MB thread-reservation=1
max-parallelism=6 segment-costs=[749813, 428467, 214644, 13268400, 82230] cpu-comparison-result=258 [max(6 (self) vs 258 (sum children))]
127:AGGREGATE [STREAMING]
|  Class 0
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, i_category_id
|  Class 1
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, i_class_id, NULL
|  Class 2
|    output: sum(sales), sum(number_sales)
|    group by: channel, i_brand_id, NULL, NULL
|  Class 3
|    output: sum(sales), sum(number_sales)
|    group by: channel, NULL, NULL, NULL
|  Class 4
|    output: sum(sales), sum(number_sales)
|    group by: NULL, NULL, NULL, NULL
|  mem-estimate=64.00MB mem-reservation=40.00MB thread-reservation=0
|  tuple-ids=104N,105N,106N,107N,108N row-size=240B cardinality=323.86K cost=8292750
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
00:UNION
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=102 row-size=48B cardinality=276.43K cost=4975650
|  in pipelines: 151(GETNEXT), 179(GETNEXT), 207(GETNEXT)
|
|--126:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 08
|  |  predicates: sum(ws_quantity * ws_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88,99 row-size=52B cardinality=42.60K cost=0
|  |  in pipelines: 207(GETNEXT), 212(OPEN)
|  |
|  |--F91:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[3] cpu-comparison-result=33 [max(3 (self) vs 33 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=08 plan-id=09 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  213:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=3
|  |  |  in pipelines: 212(GETNEXT)
|  |  |
|  |  F79:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=2 segment-costs=[2, 1] cpu-comparison-result=33 [max(2 (self) vs 33 (sum children))]
|  |  212:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=99 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 212(GETNEXT), 125(OPEN)
|  |  |
|  |  211:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 125(GETNEXT)
|  |  |
|  |  F78:PLAN FRAGMENT [RANDOM] hosts=3 instances=33 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=33 segment-costs=[314339768, 1] cpu-comparison-result=33 [max(33 (self) vs 12 (sum children))]
|  |  125:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=98 row-size=16B cardinality=1 cost=5041336
|  |  |  in pipelines: 125(GETNEXT), 116(OPEN), 119(OPEN), 122(OPEN)
|  |  |
|  |  115:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=96 row-size=8B cardinality=5.04M cost=30248016
|  |  |  in pipelines: 116(GETNEXT), 119(GETNEXT), 122(GETNEXT)
|  |  |
|  |  |--124:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=11
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=94,95 row-size=20B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 122(GETNEXT), 123(OPEN)
|  |  |  |
|  |  |  |--F94:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=11 plan-id=12 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  210:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=95 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 123(GETNEXT)
|  |  |  |  |
|  |  |  |  F77:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  123:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=95 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 123(GETNEXT)
|  |  |  |
|  |  |  122:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=94 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 122(GETNEXT)
|  |  |
|  |  |--121:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=10
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=92,93 row-size=20B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 119(GETNEXT), 120(OPEN)
|  |  |  |
|  |  |  |--F93:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=10 plan-id=11 cohort-id=04
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  209:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=93 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 120(GETNEXT)
|  |  |  |  |
|  |  |  |  F75:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  120:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=93 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 120(GETNEXT)
|  |  |  |
|  |  |  119:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=92 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 119(GETNEXT)
|  |  |
|  |  118:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=09
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=90,91 row-size=20B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 116(GETNEXT), 117(OPEN)
|  |  |
|  |  |--F92:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=09 plan-id=10 cohort-id=04
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  208:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=91 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 117(GETNEXT)
|  |  |  |
|  |  |  F73:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  117:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=91 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 117(GETNEXT)
|  |  |
|  |  116:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=90 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 116(GETNEXT)
|  |
|  207:AGGREGATE [FINALIZE]
|  |  output: sum:merge(ws_quantity * ws_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=42.60K cost=212980
|  |  in pipelines: 207(GETNEXT), 85(OPEN)
|  |
|  206:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=739.17KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=42.60K cost=1664
|  |  in pipelines: 85(GETNEXT)
|  |
|  F56:PLAN FRAGMENT [HASH(ws_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=11.61MB mem-reservation=2.00MB thread-reservation=1
|  max-parallelism=6 segment-costs=[299836, 1664] cpu-comparison-result=54 [max(12 (self) vs 54 (sum children))]
|  114:AGGREGATE [STREAMING]
|  |  output: sum(CAST(ws_quantity AS DECIMAL(10,0)) * ws_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=88 row-size=36B cardinality=42.60K cost=212980
|  |  in pipelines: 85(GETNEXT)
|  |
|  113:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=36
|  |  hash predicates: ws_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.60K cost=42596
|  |  in pipelines: 85(GETNEXT), 205(OPEN)
|  |
|  |--F119:PLAN FRAGMENT [HASH(ws_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=11.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[18186, 17975] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=36 plan-id=37 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF073[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=17975
|  |  |
|  |  205:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=8B cardinality=17.98K cost=17975
|  |  |  in pipelines: 205(GETNEXT), 192(OPEN)
|  |  |
|  |  204:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=118.81KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=170 row-size=8B cardinality=17.98K cost=211
|  |  |  in pipelines: 192(GETNEXT)
|  |  |
|  |  F60:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=20.76MB mem-reservation=3.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 1488000, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  112:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=170 row-size=8B cardinality=17.98K cost=148800
|  |  |  in pipelines: 192(GETNEXT)
|  |  |
|  |  109:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=37
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75,71 row-size=32B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 88(OPEN)
|  |  |
|  |  |--F120:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[54422]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=37 plan-id=38 cohort-id=11
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF081[min_max] <- i_brand_id, RF082[min_max] <- i_category_id, RF083[min_max] <- i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=54000
|  |  |  |
|  |  |  203:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=71 row-size=20B cardinality=18.00K cost=422
|  |  |  |  in pipelines: 88(GETNEXT)
|  |  |  |
|  |  |  F69:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  88:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=71 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 88(GETNEXT)
|  |  |
|  |  108:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=38
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 201(OPEN)
|  |  |
|  |  |--F121:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=38 plan-id=39 cohort-id=11
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  202:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 201(GETNEXT)
|  |  |  |
|  |  |  F68:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  201:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 201(GETNEXT), 100(OPEN)
|  |  |  |
|  |  |  200:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  F65:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=3.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[94805352, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  107:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=3.00MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=169 row-size=12B cardinality=148.80K cost=2158152
|  |  |  |  in pipelines: 100(GETNEXT)
|  |  |  |
|  |  |  104:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=39
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82,83 row-size=40B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 100(GETNEXT), 102(OPEN)
|  |  |  |
|  |  |  |--F122:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=39 plan-id=40 cohort-id=12
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  199:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=83 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 102(GETNEXT)
|  |  |  |  |
|  |  |  |  F67:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  102:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=83 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 102(GETNEXT)
|  |  |  |
|  |  |  103:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=40
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=81,82 row-size=32B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 100(GETNEXT), 101(OPEN)
|  |  |  |
|  |  |  |--F123:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=40 plan-id=41 cohort-id=12
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF101[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  198:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=82 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 101(GETNEXT)
|  |  |  |  |
|  |  |  |  F66:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  101:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=82 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 101(GETNEXT)
|  |  |  |
|  |  |  100:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     runtime filters: RF101[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=81 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 100(GETNEXT)
|  |  |
|  |  106:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=41
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 196(OPEN)
|  |  |
|  |  |--F124:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=41 plan-id=42 cohort-id=11
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  197:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 196(GETNEXT)
|  |  |  |
|  |  |  F64:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  196:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 196(GETNEXT), 95(OPEN)
|  |  |  |
|  |  |  195:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  F61:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[98774636, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  105:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=168 row-size=12B cardinality=148.80K cost=4324644
|  |  |  |  in pipelines: 95(GETNEXT)
|  |  |  |
|  |  |  99:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=42
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78,79 row-size=40B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 95(GETNEXT), 97(OPEN)
|  |  |  |
|  |  |  |--F125:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=42 plan-id=43 cohort-id=13
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  194:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=79 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 97(GETNEXT)
|  |  |  |  |
|  |  |  |  F63:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  97:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=79 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 97(GETNEXT)
|  |  |  |
|  |  |  98:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=43
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=77,78 row-size=32B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 95(GETNEXT), 96(OPEN)
|  |  |  |
|  |  |  |--F126:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=43 plan-id=44 cohort-id=13
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF097[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  193:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=78 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 96(GETNEXT)
|  |  |  |  |
|  |  |  |  F62:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  96:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=78 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 96(GETNEXT)
|  |  |  |
|  |  |  95:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     runtime filters: RF097[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=77 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 95(GETNEXT)
|  |  |
|  |  192:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 192(GETNEXT), 89(OPEN)
|  |  |
|  |  191:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  F57:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[105635772, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  94:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=75 row-size=12B cardinality=148.80K cost=8641212
|  |  |  in pipelines: 89(GETNEXT)
|  |  |
|  |  93:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=44
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73,74 row-size=40B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 89(GETNEXT), 91(OPEN)
|  |  |
|  |  |--F127:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=44 plan-id=45 cohort-id=11
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  190:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=74 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 91(GETNEXT)
|  |  |  |
|  |  |  F59:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  91:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=74 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 91(GETNEXT)
|  |  |
|  |  92:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=45
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=72,73 row-size=32B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 89(GETNEXT), 90(OPEN)
|  |  |
|  |  |--F128:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=45 plan-id=46 cohort-id=11
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF093[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  189:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=73 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 90(GETNEXT)
|  |  |  |
|  |  |  F58:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  90:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF081[min_max] -> iss.i_brand_id, RF082[min_max] -> iss.i_category_id, RF083[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=73 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 90(GETNEXT)
|  |  |
|  |  89:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     runtime filters: RF093[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=72 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 89(GETNEXT)
|  |
|  111:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=46
|  |  hash predicates: ws_item_sk = i_item_sk
|  |  fk/pk conjuncts: ws_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70,69 row-size=52B cardinality=42.60K cost=42596
|  |  in pipelines: 85(GETNEXT), 86(OPEN)
|  |
|  |--F129:PLAN FRAGMENT [HASH(ws_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[18422]
|  |  JOIN BUILD
|  |  |  join-table-id=46 plan-id=47 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF075[min_max] <- i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |
|  |  188:EXCHANGE [HASH(i_item_sk)]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=69 row-size=20B cardinality=18.00K cost=422
|  |  |  in pipelines: 86(GETNEXT)
|  |  |
|  |  F55:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  86:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF073[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=69 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 86(GETNEXT)
|  |
|  187:EXCHANGE [HASH(ws_item_sk)]
|  |  mem-estimate=683.71KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.60K cost=1664
|  |  in pipelines: 85(GETNEXT)
|  |
|  F53:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=128.00KB thread-reservation=1
|  max-parallelism=6 segment-costs=[5495092]
|  110:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=47
|  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=68,70 row-size=32B cardinality=42.60K cost=42596
|  |  in pipelines: 85(GETNEXT), 87(OPEN)
|  |
|  |--F130:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=3 segment-costs=[114]
|  |  JOIN BUILD
|  |  |  join-table-id=47 plan-id=48 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF076[bloom] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  186:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=70 row-size=12B cardinality=108 cost=6
|  |  |  in pipelines: 87(GETNEXT)
|  |  |
|  |  F54:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196957]
|  |  87:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=70 row-size=12B cardinality=108 cost=196955
|  |     in pipelines: 87(GETNEXT)
|  |
|  85:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=84.20MB
|     runtime filters: RF073[min_max] -> ws_item_sk, RF075[min_max] -> ws_item_sk, RF076[bloom] -> ws_sold_date_sk
|     stored statistics:
|       table: rows=719.38K size=84.20MB
|       partitions: 1824/1824 rows=719.38K
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=1.12K est-scan-range=109(filtered from 1824)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=68 row-size=20B cardinality=42.60K(filtered from 719.38K) cost=5450832
|     in pipelines: 85(GETNEXT)
|
|--84:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  |  join table id: 04
|  |  predicates: sum(cs_quantity * cs_list_price) > avg(quantity * list_price)
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54,65 row-size=52B cardinality=85.03K cost=0
|  |  in pipelines: 179(GETNEXT), 184(OPEN)
|  |
|  |--F87:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[3] cpu-comparison-result=33 [max(3 (self) vs 33 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=04 plan-id=05 cohort-id=01
|  |  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |  |
|  |  185:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=3
|  |  |  in pipelines: 184(GETNEXT)
|  |  |
|  |  F52:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=2 segment-costs=[2, 1] cpu-comparison-result=33 [max(2 (self) vs 33 (sum children))]
|  |  184:AGGREGATE [FINALIZE]
|  |  |  output: avg:merge(quantity * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=65 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 184(GETNEXT), 83(OPEN)
|  |  |
|  |  183:EXCHANGE [UNPARTITIONED]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=1
|  |  |  in pipelines: 83(GETNEXT)
|  |  |
|  |  F51:PLAN FRAGMENT [RANDOM] hosts=3 instances=33 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=33 segment-costs=[314339768, 1] cpu-comparison-result=33 [max(33 (self) vs 12 (sum children))]
|  |  83:AGGREGATE
|  |  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  |  tuple-ids=64 row-size=16B cardinality=1 cost=5041336
|  |  |  in pipelines: 83(GETNEXT), 74(OPEN), 77(OPEN), 80(OPEN)
|  |  |
|  |  73:UNION
|  |  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=62 row-size=8B cardinality=5.04M cost=30248016
|  |  |  in pipelines: 74(GETNEXT), 77(GETNEXT), 80(GETNEXT)
|  |  |
|  |  |--82:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=07
|  |  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=60,61 row-size=20B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 80(GETNEXT), 81(OPEN)
|  |  |  |
|  |  |  |--F90:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=07 plan-id=08 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  182:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=61 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 81(GETNEXT)
|  |  |  |  |
|  |  |  |  F50:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  81:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=61 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 81(GETNEXT)
|  |  |  |
|  |  |  80:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=60 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 80(GETNEXT)
|  |  |
|  |  |--79:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=06
|  |  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=58,59 row-size=20B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 77(GETNEXT), 78(OPEN)
|  |  |  |
|  |  |  |--F89:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=06 plan-id=07 cohort-id=03
|  |  |  |  |  build expressions: d_date_sk
|  |  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  181:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=59 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 78(GETNEXT)
|  |  |  |  |
|  |  |  |  F48:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  78:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=59 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 78(GETNEXT)
|  |  |  |
|  |  |  77:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=58 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 77(GETNEXT)
|  |  |
|  |  76:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=05
|  |  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=56,57 row-size=20B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 74(GETNEXT), 75(OPEN)
|  |  |
|  |  |--F88:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=05 plan-id=06 cohort-id=03
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  180:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=57 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 75(GETNEXT)
|  |  |  |
|  |  |  F46:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  75:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=57 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 75(GETNEXT)
|  |  |
|  |  74:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=56 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 74(GETNEXT)
|  |
|  179:AGGREGATE [FINALIZE]
|  |  output: sum:merge(cs_quantity * cs_list_price), count:merge(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=85.03K cost=425145
|  |  in pipelines: 179(GETNEXT), 43(OPEN)
|  |
|  178:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  mem-estimate=1.21MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=85.03K cost=3322
|  |  in pipelines: 43(GETNEXT)
|  |
|  F29:PLAN FRAGMENT [HASH(cs_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=12.04MB mem-reservation=2.00MB thread-reservation=1
|  max-parallelism=6 segment-costs=[598525, 3322] cpu-comparison-result=54 [max(12 (self) vs 54 (sum children))]
|  72:AGGREGATE [STREAMING]
|  |  output: sum(CAST(cs_quantity AS DECIMAL(10,0)) * cs_list_price), count(*)
|  |  group by: i_brand_id, i_class_id, i_category_id
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=54 row-size=36B cardinality=85.03K cost=425145
|  |  in pipelines: 43(GETNEXT)
|  |
|  71:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=24
|  |  hash predicates: cs_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.03K cost=85029
|  |  in pipelines: 43(GETNEXT), 177(OPEN)
|  |
|  |--F107:PLAN FRAGMENT [HASH(cs_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=11.94MB mem-reservation=3.88MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[18186, 17975] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=24 plan-id=25 cohort-id=01
|  |  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  runtime filters: RF037[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=17975
|  |  |
|  |  177:AGGREGATE [FINALIZE]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=17975
|  |  |  in pipelines: 177(GETNEXT), 164(OPEN)
|  |  |
|  |  176:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  |  mem-estimate=118.81KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=211
|  |  |  in pipelines: 164(GETNEXT)
|  |  |
|  |  F33:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=20.76MB mem-reservation=3.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 1488000, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  |  70:AGGREGATE [STREAMING]
|  |  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=148 row-size=8B cardinality=17.98K cost=148800
|  |  |  in pipelines: 164(GETNEXT)
|  |  |
|  |  67:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  |  hash-table-id=25
|  |  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41,37 row-size=32B cardinality=148.80K cost=446400
|  |  |  in pipelines: 164(GETNEXT), 46(OPEN)
|  |  |
|  |  |--F108:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[54422]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=25 plan-id=26 cohort-id=08
|  |  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  |  runtime filters: RF045[min_max] <- i_brand_id, RF046[min_max] <- i_category_id, RF047[min_max] <- i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=54000
|  |  |  |
|  |  |  175:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=37 row-size=20B cardinality=18.00K cost=422
|  |  |  |  in pipelines: 46(GETNEXT)
|  |  |  |
|  |  |  F42:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  46:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=37 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 46(GETNEXT)
|  |  |
|  |  66:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=26
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 164(GETNEXT), 173(OPEN)
|  |  |
|  |  |--F109:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=26 plan-id=27 cohort-id=08
|  |  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  174:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 173(GETNEXT)
|  |  |  |
|  |  |  F41:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  173:AGGREGATE [FINALIZE]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 173(GETNEXT), 58(OPEN)
|  |  |  |
|  |  |  172:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  F38:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=3.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[94805352, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  65:AGGREGATE [STREAMING]
|  |  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=3.00MB spill-buffer=128.00KB thread-reservation=0
|  |  |  |  tuple-ids=147 row-size=12B cardinality=148.80K cost=2158152
|  |  |  |  in pipelines: 58(GETNEXT)
|  |  |  |
|  |  |  62:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=27
|  |  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48,49 row-size=40B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 58(GETNEXT), 60(OPEN)
|  |  |  |
|  |  |  |--F110:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=27 plan-id=28 cohort-id=09
|  |  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  171:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=49 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 60(GETNEXT)
|  |  |  |  |
|  |  |  |  F40:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  60:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=49 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 60(GETNEXT)
|  |  |  |
|  |  |  61:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=28
|  |  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=47,48 row-size=32B cardinality=719.38K cost=719384
|  |  |  |  in pipelines: 58(GETNEXT), 59(OPEN)
|  |  |  |
|  |  |  |--F111:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=28 plan-id=29 cohort-id=09
|  |  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  |  runtime filters: RF065[min_max] <- iws.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  170:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=48 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 59(GETNEXT)
|  |  |  |  |
|  |  |  |  F39:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  59:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=48 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 59(GETNEXT)
|  |  |  |
|  |  |  58:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |  |     runtime filters: RF065[min_max] -> ws_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=719.38K size=84.20MB
|  |  |       partitions: 1824/1824 rows=719.38K
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=47 row-size=12B cardinality=719.38K cost=91208432
|  |  |     in pipelines: 58(GETNEXT)
|  |  |
|  |  64:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  |  hash-table-id=29
|  |  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 164(GETNEXT), 168(OPEN)
|  |  |
|  |  |--F112:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=29 plan-id=30 cohort-id=08
|  |  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |  |
|  |  |  169:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 168(GETNEXT)
|  |  |  |
|  |  |  F37:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  |  168:AGGREGATE [FINALIZE]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=446400
|  |  |  |  in pipelines: 168(GETNEXT), 53(OPEN)
|  |  |  |
|  |  |  167:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=2325
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  F34:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.12MB thread-reservation=1
|  |  |  max-parallelism=12 segment-costs=[98774636, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  |  63:AGGREGATE [STREAMING]
|  |  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  |  tuple-ids=146 row-size=12B cardinality=148.80K cost=4324644
|  |  |  |  in pipelines: 53(GETNEXT)
|  |  |  |
|  |  |  57:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=30
|  |  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44,45 row-size=40B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 53(GETNEXT), 55(OPEN)
|  |  |  |
|  |  |  |--F113:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=30 plan-id=31 cohort-id=10
|  |  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |  |
|  |  |  |  166:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=45 row-size=8B cardinality=7.30K cost=258
|  |  |  |  |  in pipelines: 55(GETNEXT)
|  |  |  |  |
|  |  |  |  F36:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  |  55:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     stored statistics:
|  |  |  |       table: rows=73.05K size=2.15MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |  |     tuple-ids=45 row-size=8B cardinality=7.30K cost=196669
|  |  |  |     in pipelines: 55(GETNEXT)
|  |  |  |
|  |  |  56:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  |  hash-table-id=31
|  |  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  |  tuple-ids=43,44 row-size=32B cardinality=1.44M cost=1441548
|  |  |  |  in pipelines: 53(GETNEXT), 54(OPEN)
|  |  |  |
|  |  |  |--F114:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  |  JOIN BUILD
|  |  |  |  |  join-table-id=31 plan-id=32 cohort-id=10
|  |  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  |  runtime filters: RF061[min_max] <- ics.i_item_sk
|  |  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |  |
|  |  |  |  165:EXCHANGE [BROADCAST]
|  |  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  |  tuple-ids=44 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  |  in pipelines: 54(GETNEXT)
|  |  |  |  |
|  |  |  |  F35:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  |  54:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |  |     stored statistics:
|  |  |  |       table: rows=18.00K size=1.73MB
|  |  |  |       columns: all
|  |  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |  |     tuple-ids=44 row-size=20B cardinality=18.00K cost=50352
|  |  |  |     in pipelines: 54(GETNEXT)
|  |  |  |
|  |  |  53:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |  |     runtime filters: RF061[min_max] -> cs_item_sk
|  |  |     stored statistics:
|  |  |       table: rows=1.44M size=151.13MB
|  |  |       partitions: 1831/1831 rows=1.44M
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |  |     tuple-ids=43 row-size=12B cardinality=1.44M cost=91566896
|  |  |     in pipelines: 53(GETNEXT)
|  |  |
|  |  164:AGGREGATE [FINALIZE]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 164(GETNEXT), 47(OPEN)
|  |  |
|  |  163:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  F30:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[105635772, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  52:AGGREGATE [STREAMING]
|  |  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=41 row-size=12B cardinality=148.80K cost=8641212
|  |  |  in pipelines: 47(GETNEXT)
|  |  |
|  |  51:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=32
|  |  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39,40 row-size=40B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 47(GETNEXT), 49(OPEN)
|  |  |
|  |  |--F115:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=32 plan-id=33 cohort-id=08
|  |  |  |  build expressions: d1.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  162:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=40 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 49(GETNEXT)
|  |  |  |
|  |  |  F32:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  49:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=40 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 49(GETNEXT)
|  |  |
|  |  50:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=33
|  |  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=38,39 row-size=32B cardinality=2.88M cost=2880404
|  |  |  in pipelines: 47(GETNEXT), 48(OPEN)
|  |  |
|  |  |--F116:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=33 plan-id=34 cohort-id=08
|  |  |  |  build expressions: iss.i_item_sk
|  |  |  |  runtime filters: RF057[min_max] <- iss.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  161:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=39 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 48(GETNEXT)
|  |  |  |
|  |  |  F31:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  48:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     runtime filters: RF045[min_max] -> iss.i_brand_id, RF046[min_max] -> iss.i_category_id, RF047[min_max] -> iss.i_class_id
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=39 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 48(GETNEXT)
|  |  |
|  |  47:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=199.36MB
|  |     runtime filters: RF057[min_max] -> ss_item_sk
|  |     stored statistics:
|  |       table: rows=2.88M size=199.36MB
|  |       partitions: 1824/1824 rows=2.88M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=130.09K
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=38 row-size=12B cardinality=2.88M cost=91233752
|  |     in pipelines: 47(GETNEXT)
|  |
|  69:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=34
|  |  hash predicates: cs_item_sk = i_item_sk
|  |  fk/pk conjuncts: cs_item_sk = i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36,35 row-size=52B cardinality=85.03K cost=85029
|  |  in pipelines: 43(GETNEXT), 44(OPEN)
|  |
|  |--F117:PLAN FRAGMENT [HASH(cs_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=2.30MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[18422]
|  |  JOIN BUILD
|  |  |  join-table-id=34 plan-id=35 cohort-id=01
|  |  |  build expressions: i_item_sk
|  |  |  runtime filters: RF039[min_max] <- i_item_sk
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |
|  |  160:EXCHANGE [HASH(i_item_sk)]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=35 row-size=20B cardinality=18.00K cost=422
|  |  |  in pipelines: 44(GETNEXT)
|  |  |
|  |  F28:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  44:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF037[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=35 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 44(GETNEXT)
|  |
|  159:EXCHANGE [HASH(cs_item_sk)]
|  |  mem-estimate=1.10MB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=34,36 row-size=32B cardinality=85.03K cost=3322
|  |  in pipelines: 43(GETNEXT)
|  |
|  F26:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.94MB mem-reservation=128.00KB thread-reservation=1
|  max-parallelism=6 segment-costs=[5540012]
|  68:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=35
|  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=34,36 row-size=32B cardinality=85.03K cost=85029
|  |  in pipelines: 43(GETNEXT), 45(OPEN)
|  |
|  |--F118:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  |  max-parallelism=3 segment-costs=[114]
|  |  JOIN BUILD
|  |  |  join-table-id=35 plan-id=36 cohort-id=01
|  |  |  build expressions: d_date_sk
|  |  |  runtime filters: RF040[bloom] <- d_date_sk
|  |  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |  |
|  |  158:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=36 row-size=12B cardinality=108 cost=6
|  |  |  in pipelines: 45(GETNEXT)
|  |  |
|  |  F27:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196957]
|  |  45:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=36 row-size=12B cardinality=108 cost=196955
|  |     in pipelines: 45(GETNEXT)
|  |
|  43:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|     HDFS partitions=1831/1831 files=1831 size=151.13MB
|     runtime filters: RF037[min_max] -> cs_item_sk, RF039[min_max] -> cs_item_sk, RF040[bloom] -> cs_sold_date_sk
|     stored statistics:
|       table: rows=1.44M size=151.13MB
|       partitions: 1831/1831 rows=1.44M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=7.18K est-scan-range=109(filtered from 1831)
|     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|     tuple-ids=34 row-size=20B cardinality=85.03K(filtered from 1.44M) cost=5451661
|     in pipelines: 43(GETNEXT)
|
42:NESTED LOOP JOIN [INNER JOIN, BROADCAST]
|  join table id: 00
|  predicates: sum(ss_quantity * ss_list_price) > avg(quantity * list_price)
|  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  tuple-ids=20,31 row-size=52B cardinality=148.80K cost=0
|  in pipelines: 151(GETNEXT), 156(OPEN)
|
|--F83:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=16.02KB mem-reservation=0B thread-reservation=1
|  |  max-parallelism=3 segment-costs=[3] cpu-comparison-result=33 [max(3 (self) vs 33 (sum children))]
|  JOIN BUILD
|  |  join-table-id=00 plan-id=01 cohort-id=01
|  |  mem-estimate=16B mem-reservation=0B thread-reservation=0 cost=0
|  |
|  157:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=3
|  |  in pipelines: 156(GETNEXT)
|  |
|  F25:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=96.00KB mem-reservation=0B thread-reservation=1
|  max-parallelism=2 segment-costs=[2, 1] cpu-comparison-result=33 [max(2 (self) vs 33 (sum children))]
|  156:AGGREGATE [FINALIZE]
|  |  output: avg:merge(quantity * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=31 row-size=16B cardinality=1 cost=1
|  |  in pipelines: 156(GETNEXT), 41(OPEN)
|  |
|  155:EXCHANGE [UNPARTITIONED]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=1
|  |  in pipelines: 41(GETNEXT)
|  |
|  F24:PLAN FRAGMENT [RANDOM] hosts=3 instances=33 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=16.02MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=33 segment-costs=[314339768, 1] cpu-comparison-result=33 [max(33 (self) vs 12 (sum children))]
|  41:AGGREGATE
|  |  output: avg(CAST(quantity AS DECIMAL(10,0)) * list_price)
|  |  mem-estimate=16.00KB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0
|  |  tuple-ids=30 row-size=16B cardinality=1 cost=5041336
|  |  in pipelines: 41(GETNEXT), 32(OPEN), 35(OPEN), 38(OPEN)
|  |
|  31:UNION
|  |  mem-estimate=0B mem-reservation=0B thread-reservation=0
|  |  tuple-ids=28 row-size=8B cardinality=5.04M cost=30248016
|  |  in pipelines: 32(GETNEXT), 35(GETNEXT), 38(GETNEXT)
|  |
|  |--40:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=03
|  |  |  hash predicates: ws_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=26,27 row-size=20B cardinality=719.38K cost=719384
|  |  |  in pipelines: 38(GETNEXT), 39(OPEN)
|  |  |
|  |  |--F86:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=03 plan-id=04 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  154:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=27 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 39(GETNEXT)
|  |  |  |
|  |  |  F23:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  39:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=27 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 39(GETNEXT)
|  |  |
|  |  38:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |     stored statistics:
|  |       table: rows=719.38K size=84.20MB
|  |       partitions: 1824/1824 rows=719.38K
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=26 row-size=12B cardinality=719.38K cost=91208432
|  |     in pipelines: 38(GETNEXT)
|  |
|  |--37:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=02
|  |  |  hash predicates: cs_sold_date_sk = d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=24,25 row-size=20B cardinality=1.44M cost=1441548
|  |  |  in pipelines: 35(GETNEXT), 36(OPEN)
|  |  |
|  |  |--F85:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=02 plan-id=03 cohort-id=02
|  |  |  |  build expressions: d_date_sk
|  |  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  153:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=25 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 36(GETNEXT)
|  |  |  |
|  |  |  F21:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  36:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=25 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 36(GETNEXT)
|  |  |
|  |  35:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |     stored statistics:
|  |       table: rows=1.44M size=151.13MB
|  |       partitions: 1831/1831 rows=1.44M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=24 row-size=12B cardinality=1.44M cost=91566896
|  |     in pipelines: 35(GETNEXT)
|  |
|  34:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=01
|  |  hash predicates: ss_sold_date_sk = d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=22,23 row-size=20B cardinality=2.88M cost=2880404
|  |  in pipelines: 32(GETNEXT), 33(OPEN)
|  |
|  |--F84:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=21.38MB mem-reservation=21.31MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[7563]
|  |  JOIN BUILD
|  |  |  join-table-id=01 plan-id=02 cohort-id=02
|  |  |  build expressions: d_date_sk
|  |  |  mem-estimate=21.31MB mem-reservation=21.31MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  152:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=23 row-size=8B cardinality=7.30K cost=258
|  |  |  in pipelines: 33(GETNEXT)
|  |  |
|  |  F19:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196755]
|  |  33:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d_year <= CAST(2001 AS INT), d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=23 row-size=8B cardinality=7.30K cost=196669
|  |     in pipelines: 33(GETNEXT)
|  |
|  32:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=199.36MB
|     stored statistics:
|       table: rows=2.88M size=199.36MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=22 row-size=12B cardinality=2.88M cost=91233752
|     in pipelines: 32(GETNEXT)
|
151:AGGREGATE [FINALIZE]
|  output: sum:merge(ss_quantity * ss_list_price), count:merge(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=2.88MB spill-buffer=128.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=148.80K cost=744000
|  in pipelines: 151(GETNEXT), 01(OPEN)
|
150:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  mem-estimate=1.94MB mem-reservation=0B thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=148.80K cost=5813
|  in pipelines: 01(GETNEXT)
|
F00:PLAN FRAGMENT [RANDOM] hosts=3 instances=6 (adjusted from 48)
Per-Host Shared Resources: mem-estimate=3.00MB mem-reservation=3.00MB thread-reservation=0 runtime-filters-memory=3.00MB
Per-Instance Resources: mem-estimate=26.94MB mem-reservation=3.00MB thread-reservation=1
max-parallelism=6 segment-costs=[6817739, 5813] cpu-comparison-result=51 [max(6 (self) vs 51 (sum children))]
30:AGGREGATE [STREAMING]
|  output: sum(CAST(ss_quantity AS DECIMAL(10,0)) * ss_list_price), count(*)
|  group by: i_brand_id, i_class_id, i_category_id
|  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=20 row-size=36B cardinality=148.80K cost=852755
|  in pipelines: 01(GETNEXT)
|
29:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash-table-id=12
|  hash predicates: ss_item_sk = tpcds_partitioned_parquet_snap.item.i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K cost=170551
|  in pipelines: 01(GETNEXT), 148(OPEN)
|
|--F95:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=5.08MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=3 segment-costs=[18608] cpu-comparison-result=43 [max(3 (self) vs 43 (sum children))]
|  JOIN BUILD
|  |  join-table-id=12 plan-id=13 cohort-id=01
|  |  build expressions: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  runtime filters: RF000[bloom] <- tpcds_partitioned_parquet_snap.item.i_item_sk, RF001[min_max] <- tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=17975
|  |
|  149:EXCHANGE [BROADCAST]
|  |  mem-estimate=212.43KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=633
|  |  in pipelines: 148(GETNEXT)
|  |
|  F16:PLAN FRAGMENT [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)] hosts=3 instances=6 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=10.12MB mem-reservation=1.94MB thread-reservation=1
|  max-parallelism=6 segment-costs=[18186, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  148:AGGREGATE [FINALIZE]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=17975
|  |  in pipelines: 148(GETNEXT), 135(OPEN)
|  |
|  147:EXCHANGE [HASH(tpcds_partitioned_parquet_snap.item.i_item_sk)]
|  |  mem-estimate=118.81KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=211
|  |  in pipelines: 135(GETNEXT)
|  |
|  F06:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=20.76MB mem-reservation=3.94MB thread-reservation=1
|  max-parallelism=6 segment-costs=[448725, 1488000, 211] cpu-comparison-result=43 [max(6 (self) vs 43 (sum children))]
|  28:AGGREGATE [STREAMING]
|  |  group by: tpcds_partitioned_parquet_snap.item.i_item_sk
|  |  mem-estimate=10.00MB mem-reservation=2.00MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=126 row-size=8B cardinality=17.98K cost=148800
|  |  in pipelines: 135(GETNEXT)
|  |
|  25:HASH JOIN [INNER JOIN, PARTITIONED]
|  |  hash-table-id=13
|  |  hash predicates: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  fk/pk conjuncts: iss.i_brand_id = i_brand_id, iss.i_category_id = i_category_id, iss.i_class_id = i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7,3 row-size=32B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 04(OPEN)
|  |
|  |--F96:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=5.30MB mem-reservation=4.94MB thread-reservation=1 runtime-filters-memory=3.00MB
|  |  |  max-parallelism=6 segment-costs=[54422]
|  |  JOIN BUILD
|  |  |  join-table-id=13 plan-id=14 cohort-id=05
|  |  |  build expressions: i_brand_id, i_category_id, i_class_id
|  |  |  runtime filters: RF006[bloom] <- i_brand_id, RF007[bloom] <- i_category_id, RF008[bloom] <- i_class_id, RF009[min_max] <- i_brand_id, RF010[min_max] <- i_category_id, RF011[min_max] <- i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=54000
|  |  |
|  |  146:EXCHANGE [HASH(i_brand_id,i_class_id,i_category_id)]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=3 row-size=20B cardinality=18.00K cost=422
|  |  |  in pipelines: 04(GETNEXT)
|  |  |
|  |  F15:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.56MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  04:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=3 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 04(GETNEXT)
|  |
|  24:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=14
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM iws.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM iws.i_category_id, iss.i_class_id IS NOT DISTINCT FROM iws.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 144(OPEN)
|  |
|  |--F97:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=4.60MB mem-reservation=3.94MB thread-reservation=1 runtime-filters-memory=2.00MB
|  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=14 plan-id=15 cohort-id=05
|  |  |  build expressions: iws.i_brand_id, iws.i_category_id, iws.i_class_id
|  |  |  runtime filters: RF012[bloom] <- iws.i_brand_id, RF013[bloom] <- iws.i_category_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |
|  |  145:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 144(GETNEXT)
|  |  |
|  |  F14:PLAN FRAGMENT [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  144:AGGREGATE [FINALIZE]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 144(GETNEXT), 16(OPEN)
|  |  |
|  |  143:EXCHANGE [HASH(iws.i_brand_id,iws.i_class_id,iws.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  F11:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=3.12MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[94805352, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  23:AGGREGATE [STREAMING]
|  |  |  group by: iws.i_brand_id, iws.i_class_id, iws.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=3.00MB spill-buffer=128.00KB thread-reservation=0
|  |  |  tuple-ids=125 row-size=12B cardinality=148.80K cost=2158152
|  |  |  in pipelines: 16(GETNEXT)
|  |  |
|  |  20:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=15
|  |  |  hash predicates: ws_sold_date_sk = d3.d_date_sk
|  |  |  fk/pk conjuncts: ws_sold_date_sk = d3.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14,15 row-size=40B cardinality=719.38K cost=719384
|  |  |  in pipelines: 16(GETNEXT), 18(OPEN)
|  |  |
|  |  |--F98:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=15 plan-id=16 cohort-id=06
|  |  |  |  build expressions: d3.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  142:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=15 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 18(GETNEXT)
|  |  |  |
|  |  |  F13:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  18:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d3, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d3.d_year <= CAST(2001 AS INT), d3.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=15 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 18(GETNEXT)
|  |  |
|  |  19:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=16
|  |  |  hash predicates: ws_item_sk = iws.i_item_sk
|  |  |  fk/pk conjuncts: ws_item_sk = iws.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=13,14 row-size=32B cardinality=719.38K cost=719384
|  |  |  in pipelines: 16(GETNEXT), 17(OPEN)
|  |  |
|  |  |--F99:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=16 plan-id=17 cohort-id=06
|  |  |  |  build expressions: iws.i_item_sk
|  |  |  |  runtime filters: RF029[min_max] <- iws.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  141:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=14 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 17(GETNEXT)
|  |  |  |
|  |  |  F12:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  17:SCAN HDFS [tpcds_partitioned_parquet_snap.item iws, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=14 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 17(GETNEXT)
|  |  |
|  |  16:SCAN HDFS [tpcds_partitioned_parquet_snap.web_sales, RANDOM]
|  |     HDFS partitions=1824/1824 files=1824 size=84.20MB
|  |     runtime filters: RF029[min_max] -> ws_item_sk
|  |     stored statistics:
|  |       table: rows=719.38K size=84.20MB
|  |       partitions: 1824/1824 rows=719.38K
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=1.12K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=13 row-size=12B cardinality=719.38K cost=91208432
|  |     in pipelines: 16(GETNEXT)
|  |
|  22:HASH JOIN [LEFT SEMI JOIN, PARTITIONED]
|  |  hash-table-id=17
|  |  hash predicates: iss.i_brand_id IS NOT DISTINCT FROM ics.i_brand_id, iss.i_category_id IS NOT DISTINCT FROM ics.i_category_id, iss.i_class_id IS NOT DISTINCT FROM ics.i_class_id
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 139(OPEN)
|  |
|  |--F100:PLAN FRAGMENT [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  |  Per-Instance Resources: mem-estimate=2.60MB mem-reservation=1.94MB thread-reservation=1
|  |  |  max-parallelism=6 segment-costs=[448725] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  JOIN BUILD
|  |  |  join-table-id=17 plan-id=18 cohort-id=05
|  |  |  build expressions: ics.i_brand_id, ics.i_category_id, ics.i_class_id
|  |  |  mem-estimate=1.94MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0 cost=446400
|  |  |
|  |  140:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=677.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 139(GETNEXT)
|  |  |
|  |  F10:PLAN FRAGMENT [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)] hosts=3 instances=6 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=10.76MB mem-reservation=1.94MB thread-reservation=1
|  |  max-parallelism=6 segment-costs=[448725, 2325] cpu-comparison-result=12 [max(6 (self) vs 12 (sum children))]
|  |  139:AGGREGATE [FINALIZE]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=446400
|  |  |  in pipelines: 139(GETNEXT), 11(OPEN)
|  |  |
|  |  138:EXCHANGE [HASH(ics.i_brand_id,ics.i_class_id,ics.i_category_id)]
|  |  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=2325
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  F07:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  |  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.12MB thread-reservation=1
|  |  max-parallelism=12 segment-costs=[98774636, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  |  21:AGGREGATE [STREAMING]
|  |  |  group by: ics.i_brand_id, ics.i_class_id, ics.i_category_id
|  |  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  |  tuple-ids=124 row-size=12B cardinality=148.80K cost=4324644
|  |  |  in pipelines: 11(GETNEXT)
|  |  |
|  |  15:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=18
|  |  |  hash predicates: cs_sold_date_sk = d2.d_date_sk
|  |  |  fk/pk conjuncts: cs_sold_date_sk = d2.d_date_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10,11 row-size=40B cardinality=1.44M cost=1441548
|  |  |  in pipelines: 11(GETNEXT), 13(OPEN)
|  |  |
|  |  |--F101:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[7563]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=18 plan-id=19 cohort-id=07
|  |  |  |  build expressions: d2.d_date_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |  |
|  |  |  137:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=11 row-size=8B cardinality=7.30K cost=258
|  |  |  |  in pipelines: 13(GETNEXT)
|  |  |  |
|  |  |  F09:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[196755]
|  |  |  13:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d2, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |  |     predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     stored statistics:
|  |  |       table: rows=73.05K size=2.15MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |  |     parquet statistics predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     parquet dictionary predicates: d2.d_year <= CAST(2001 AS INT), d2.d_year >= CAST(1999 AS INT)
|  |  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |  |     tuple-ids=11 row-size=8B cardinality=7.30K cost=196669
|  |  |     in pipelines: 13(GETNEXT)
|  |  |
|  |  14:HASH JOIN [INNER JOIN, BROADCAST]
|  |  |  hash-table-id=19
|  |  |  hash predicates: cs_item_sk = ics.i_item_sk
|  |  |  fk/pk conjuncts: cs_item_sk = ics.i_item_sk
|  |  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  |  tuple-ids=9,10 row-size=32B cardinality=1.44M cost=1441548
|  |  |  in pipelines: 11(GETNEXT), 12(OPEN)
|  |  |
|  |  |--F102:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  |  max-parallelism=3 segment-costs=[19266]
|  |  |  JOIN BUILD
|  |  |  |  join-table-id=19 plan-id=20 cohort-id=07
|  |  |  |  build expressions: ics.i_item_sk
|  |  |  |  runtime filters: RF025[min_max] <- ics.i_item_sk
|  |  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |  |
|  |  |  136:EXCHANGE [BROADCAST]
|  |  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  |  tuple-ids=10 row-size=20B cardinality=18.00K cost=1266
|  |  |  |  in pipelines: 12(GETNEXT)
|  |  |  |
|  |  |  F08:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  |  max-parallelism=1 segment-costs=[50774]
|  |  |  12:SCAN HDFS [tpcds_partitioned_parquet_snap.item ics, RANDOM]
|  |  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |  |     stored statistics:
|  |  |       table: rows=18.00K size=1.73MB
|  |  |       columns: all
|  |  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |  |     tuple-ids=10 row-size=20B cardinality=18.00K cost=50352
|  |  |     in pipelines: 12(GETNEXT)
|  |  |
|  |  11:SCAN HDFS [tpcds_partitioned_parquet_snap.catalog_sales, RANDOM]
|  |     HDFS partitions=1831/1831 files=1831 size=151.13MB
|  |     runtime filters: RF025[min_max] -> cs_item_sk
|  |     stored statistics:
|  |       table: rows=1.44M size=151.13MB
|  |       partitions: 1831/1831 rows=1.44M
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=7.18K
|  |     mem-estimate=16.00MB mem-reservation=128.00KB thread-reservation=0
|  |     tuple-ids=9 row-size=12B cardinality=1.44M cost=91566896
|  |     in pipelines: 11(GETNEXT)
|  |
|  135:AGGREGATE [FINALIZE]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=1.94MB spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=446400
|  |  in pipelines: 135(GETNEXT), 05(OPEN)
|  |
|  134:EXCHANGE [HASH(iss.i_brand_id,iss.i_class_id,iss.i_category_id)]
|  |  mem-estimate=773.25KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=2325
|  |  in pipelines: 05(GETNEXT)
|  |
|  F03:PLAN FRAGMENT [RANDOM] hosts=3 instances=12 (adjusted from 48)
|  Per-Instance Resources: mem-estimate=26.38MB mem-reservation=5.50MB thread-reservation=1
|  max-parallelism=12 segment-costs=[105635772, 2325] cpu-comparison-result=12 [max(12 (self) vs 8 (sum children))]
|  10:AGGREGATE [STREAMING]
|  |  group by: iss.i_brand_id, iss.i_class_id, iss.i_category_id
|  |  mem-estimate=10.00MB mem-reservation=5.00MB spill-buffer=256.00KB thread-reservation=0
|  |  tuple-ids=7 row-size=12B cardinality=148.80K cost=8641212
|  |  in pipelines: 05(GETNEXT)
|  |
|  09:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=20
|  |  hash predicates: ss_sold_date_sk = d1.d_date_sk
|  |  fk/pk conjuncts: ss_sold_date_sk = d1.d_date_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5,6 row-size=40B cardinality=2.88M cost=2880404
|  |  in pipelines: 05(GETNEXT), 07(OPEN)
|  |
|  |--F103:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=7.82MB mem-reservation=7.75MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[7563]
|  |  JOIN BUILD
|  |  |  join-table-id=20 plan-id=21 cohort-id=05
|  |  |  build expressions: d1.d_date_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=7305
|  |  |
|  |  133:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=69.07KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=6 row-size=8B cardinality=7.30K cost=258
|  |  |  in pipelines: 07(GETNEXT)
|  |  |
|  |  F05:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Instance Resources: mem-estimate=16.05MB mem-reservation=512.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[196755]
|  |  07:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim d1, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=2.15MB
|  |     predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     stored statistics:
|  |       table: rows=73.05K size=2.15MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=73.05K
|  |     parquet statistics predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     parquet dictionary predicates: d1.d_year <= CAST(2001 AS INT), d1.d_year >= CAST(1999 AS INT)
|  |     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|  |     tuple-ids=6 row-size=8B cardinality=7.30K cost=196669
|  |     in pipelines: 07(GETNEXT)
|  |
|  08:HASH JOIN [INNER JOIN, BROADCAST]
|  |  hash-table-id=21
|  |  hash predicates: ss_item_sk = iss.i_item_sk
|  |  fk/pk conjuncts: ss_item_sk = iss.i_item_sk
|  |  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  |  tuple-ids=4,5 row-size=32B cardinality=2.88M cost=2880404
|  |  in pipelines: 05(GETNEXT), 06(OPEN)
|  |
|  |--F104:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  |  Per-Instance Resources: mem-estimate=8.12MB mem-reservation=7.75MB thread-reservation=1
|  |  |  max-parallelism=3 segment-costs=[19266]
|  |  JOIN BUILD
|  |  |  join-table-id=21 plan-id=22 cohort-id=05
|  |  |  build expressions: iss.i_item_sk
|  |  |  runtime filters: RF021[min_max] <- iss.i_item_sk
|  |  |  mem-estimate=7.75MB mem-reservation=7.75MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |  |
|  |  132:EXCHANGE [BROADCAST]
|  |  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  |  tuple-ids=5 row-size=20B cardinality=18.00K cost=1266
|  |  |  in pipelines: 06(GETNEXT)
|  |  |
|  |  F04:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  |  Per-Host Shared Resources: mem-estimate=5.00MB mem-reservation=5.00MB thread-reservation=0 runtime-filters-memory=5.00MB
|  |  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  |  max-parallelism=1 segment-costs=[50774]
|  |  06:SCAN HDFS [tpcds_partitioned_parquet_snap.item iss, RANDOM]
|  |     HDFS partitions=1/1 files=1 size=1.73MB
|  |     runtime filters: RF009[min_max] -> iss.i_brand_id, RF010[min_max] -> iss.i_category_id, RF011[min_max] -> iss.i_class_id, RF006[bloom] -> iss.i_brand_id, RF007[bloom] -> iss.i_category_id, RF008[bloom] -> iss.i_class_id, RF012[bloom] -> iss.i_brand_id, RF013[bloom] -> iss.i_category_id
|  |     stored statistics:
|  |       table: rows=18.00K size=1.73MB
|  |       columns: all
|  |     extrapolated-rows=disabled max-scan-range-rows=18.00K
|  |     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|  |     tuple-ids=5 row-size=20B cardinality=18.00K cost=50352
|  |     in pipelines: 06(GETNEXT)
|  |
|  05:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
|     HDFS partitions=1824/1824 files=1824 size=199.36MB
|     runtime filters: RF021[min_max] -> ss_item_sk
|     stored statistics:
|       table: rows=2.88M size=199.36MB
|       partitions: 1824/1824 rows=2.88M
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=130.09K
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=4 row-size=12B cardinality=2.88M cost=91233752
|     in pipelines: 05(GETNEXT)
|
27:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=22
|  hash predicates: ss_item_sk = i_item_sk
|  fk/pk conjuncts: ss_item_sk = i_item_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2,1 row-size=52B cardinality=170.55K cost=170551
|  in pipelines: 01(GETNEXT), 02(OPEN)
|
|--F105:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=5.24MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=3 segment-costs=[19266]
|  JOIN BUILD
|  |  join-table-id=22 plan-id=23 cohort-id=01
|  |  build expressions: i_item_sk
|  |  runtime filters: RF002[bloom] <- i_item_sk, RF003[min_max] <- i_item_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=18000
|  |
|  131:EXCHANGE [BROADCAST]
|  |  mem-estimate=375.56KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=1 row-size=20B cardinality=18.00K cost=1266
|  |  in pipelines: 02(GETNEXT)
|  |
|  F02:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Host Shared Resources: mem-estimate=1.00MB mem-reservation=1.00MB thread-reservation=0 runtime-filters-memory=1.00MB
|  Per-Instance Resources: mem-estimate=16.09MB mem-reservation=256.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[50774]
|  02:SCAN HDFS [tpcds_partitioned_parquet_snap.item, RANDOM]
|     HDFS partitions=1/1 files=1 size=1.73MB
|     runtime filters: RF001[min_max] -> tpcds_partitioned_parquet_snap.item.i_item_sk, RF000[bloom] -> tpcds_partitioned_parquet_snap.item.i_item_sk
|     stored statistics:
|       table: rows=18.00K size=1.73MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=18.00K
|     mem-estimate=16.00MB mem-reservation=256.00KB thread-reservation=0
|     tuple-ids=1 row-size=20B cardinality=18.00K cost=50352
|     in pipelines: 02(GETNEXT)
|
26:HASH JOIN [INNER JOIN, BROADCAST]
|  hash-table-id=23
|  hash predicates: ss_sold_date_sk = d_date_sk
|  fk/pk conjuncts: ss_sold_date_sk = d_date_sk
|  mem-estimate=0B mem-reservation=0B spill-buffer=64.00KB thread-reservation=0
|  tuple-ids=0,2 row-size=32B cardinality=170.55K cost=170551
|  in pipelines: 01(GETNEXT), 03(OPEN)
|
|--F106:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
|  |  Per-Instance Resources: mem-estimate=4.89MB mem-reservation=4.88MB thread-reservation=1 runtime-filters-memory=1.00MB
|  |  max-parallelism=3 segment-costs=[114]
|  JOIN BUILD
|  |  join-table-id=23 plan-id=24 cohort-id=01
|  |  build expressions: d_date_sk
|  |  runtime filters: RF004[bloom] <- d_date_sk
|  |  mem-estimate=3.88MB mem-reservation=3.88MB spill-buffer=64.00KB thread-reservation=0 cost=108
|  |
|  130:EXCHANGE [BROADCAST]
|  |  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0
|  |  tuple-ids=2 row-size=12B cardinality=108 cost=6
|  |  in pipelines: 03(GETNEXT)
|  |
|  F01:PLAN FRAGMENT [RANDOM] hosts=1 instances=1
|  Per-Instance Resources: mem-estimate=16.06MB mem-reservation=512.00KB thread-reservation=1
|  max-parallelism=1 segment-costs=[196957]
|  03:SCAN HDFS [tpcds_partitioned_parquet_snap.date_dim, RANDOM]
|     HDFS partitions=1/1 files=1 size=2.15MB
|     predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     stored statistics:
|       table: rows=73.05K size=2.15MB
|       columns: all
|     extrapolated-rows=disabled max-scan-range-rows=73.05K
|     parquet statistics predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     parquet dictionary predicates: d_year = CAST(2001 AS INT), d_moy = CAST(11 AS INT)
|     mem-estimate=16.00MB mem-reservation=512.00KB thread-reservation=0
|     tuple-ids=2 row-size=12B cardinality=108 cost=196955
|     in pipelines: 03(GETNEXT)
|
01:SCAN HDFS [tpcds_partitioned_parquet_snap.store_sales, RANDOM]
   HDFS partitions=1824/1824 files=1824 size=199.36MB
   runtime filters: RF001[min_max] -> ss_item_sk, RF003[min_max] -> ss_item_sk, RF004[bloom] -> ss_sold_date_sk, RF000[bloom] -> ss_item_sk, RF002[bloom] -> ss_item_sk
   stored statistics:
     table: rows=2.88M size=199.36MB
     partitions: 1824/1824 rows=2.88M
     columns: all
   extrapolated-rows=disabled max-scan-range-rows=130.09K est-scan-range=109(filtered from 1824)
   mem-estimate=16.00MB mem-reservation=1.00MB thread-reservation=0
   tuple-ids=0 row-size=20B cardinality=170.55K(filtered from 2.88M) cost=5453331
   in pipelines: 01(GETNEXT)
====
